% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\usepackage{fontspec}
\usepackage{amsmath}
\usepackage{calligra}
\usepackage{amsmath}
\defaultfontfeatures[\rmfamily,\sffamily]{Ligatures=TeX,Numbers=OldStyle}
\setmainfont{Libertinus Serif}
\setsansfont{Libertinus Sans}
\setmathfont{Libertinus Math}%[RawFeature={+ss08}
\setmonofont{Libertinus Mono}
\usepackage{eurosym}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Time series forecasting},
  pdfauthor={Jaakko Paavola},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Time series forecasting}
\author{Jaakko Paavola}
\date{19 Mar 2024}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{2}
\tableofcontents
}
\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{options}\NormalTok{(}\AttributeTok{wid\_of\_tsth=}\DecValTok{10000}\NormalTok{)}
\FunctionTok{options}\NormalTok{(}\AttributeTok{setWid\_of\_tsthOnResize=}\ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{preprocess\_data }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(}\AttributeTok{since =} \ConstantTok{NULL}\NormalTok{, query, }\AttributeTok{first.month.to.forecast =} \ConstantTok{NULL}\NormalTok{)\{}
  \DocumentationTok{\#\#\# Fetches the data and does preprocessing on it. Checks whether there is complete data (data from the last day) from the month before the current one.}
  \DocumentationTok{\#\#\# Parameters:}
  \DocumentationTok{\#\#\# since: The earliest date for data we want to fetch.}
  \DocumentationTok{\#\#\# query: The name of the query.}
  \DocumentationTok{\#\#\# prevMonthCheckFlag: TRUE if we want to check whether there is data from the last day of the previous month. Otherwise FALSE.}
  \DocumentationTok{\#\#\# Returns: }
  \DocumentationTok{\#\#\# If there was complete data from the previous month, returns the fetched dataset.}
  \DocumentationTok{\#\#\# If there was no complete data from the previous month, returns 1.}
  
  \FunctionTok{flog.info}\NormalTok{(}\StringTok{"Loading data"}\NormalTok{)}
  
  \ControlFlowTok{if}\NormalTok{ (query }\SpecialCharTok{==} \StringTok{"USGDPGR"}\NormalTok{) \{}
    \CommentTok{\# Import data from file "united{-}states{-}gdp{-}growth{-}rate.csv"}
\NormalTok{    data }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"original\_data/united{-}states{-}gdp{-}growth{-}rate.csv"}\NormalTok{, }\AttributeTok{header =}\NormalTok{ T)}
\NormalTok{  \}}

  \CommentTok{\# Rename columns in data to "Date" and "Value"}
  \FunctionTok{colnames}\NormalTok{(data) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Date"}\NormalTok{, query)}
\NormalTok{  data}\SpecialCharTok{$}\NormalTok{Date }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Date, }\StringTok{"\%d/\%m/\%Y"}\NormalTok{)}

  \CommentTok{\# since = "2013{-}02{-}01"}
  \ControlFlowTok{if}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.null}\NormalTok{(since)) \{}
\NormalTok{    since }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(since, }\StringTok{"\%Y{-}\%m{-}\%d"}\NormalTok{)}
\NormalTok{  \}}
 
  \ControlFlowTok{if}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.null}\NormalTok{(since)) \{}
\NormalTok{    data }\OtherTok{\textless{}{-}}\NormalTok{ data[data}\SpecialCharTok{$}\NormalTok{Date }\SpecialCharTok{\textgreater{}=}\NormalTok{ since,]}
\NormalTok{    data }\OtherTok{\textless{}{-}}\NormalTok{ data[}\FunctionTok{order}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Date),]}
\NormalTok{  \}}

\NormalTok{  data }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(data)}
  \CommentTok{\# print(data)}

  \CommentTok{\# if(!is.null(first.month.to.forecast)) \{}
  \CommentTok{\#   if(max(data$Date) \textless{} as.Date(as.yearmon(first.month.to.forecast)) {-} 1) \{}
  \CommentTok{\#     stop(paste0("No complete data from previous month (", month(as.Date(as.yearmon(Sys.Date())) {-} 1, abbr = TRUE, label = T), ")"))}
  \CommentTok{\#   \}}
  \CommentTok{\# \}}
  
  \FunctionTok{return}\NormalTok{(data)}
\NormalTok{\}}

\NormalTok{monthly\_decomposition }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(dataFull, id\_of\_ts, imputations.output.filename)\{}
  \DocumentationTok{\#\#\# Composes a time series object and does imputations in it.}
  \DocumentationTok{\#\#\# Parameters:}
  \DocumentationTok{\#\#\# imputations.output.filename: if the parameter is given, the imputation information will be printed out to a file.}
  \DocumentationTok{\#\#\# Returns: A list with a time series component with the realized demands as the first element.}

  \CommentTok{\# Fill the time series if there are any NAs}
\NormalTok{  index }\OtherTok{\textless{}{-}} \FunctionTok{as.integer}\NormalTok{(}\FunctionTok{min}\NormalTok{(}\FunctionTok{which}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(dataFull[, id\_of\_ts]))))}
\NormalTok{  cleaned\_data }\OtherTok{\textless{}{-}}\NormalTok{ dataFull}
\NormalTok{  cleaned\_data[, id\_of\_ts] }\OtherTok{\textless{}{-}} \FunctionTok{ifelse}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(dataFull[, id\_of\_ts]), }\DecValTok{0}\NormalTok{, dataFull[, id\_of\_ts])}
\NormalTok{  cleaned\_data }\OtherTok{\textless{}{-}}\NormalTok{ cleaned\_data[index}\SpecialCharTok{:}\FunctionTok{nrow}\NormalTok{(cleaned\_data), ]}
\NormalTok{  cleaned\_data[, id\_of\_ts] }\OtherTok{\textless{}{-}} \FunctionTok{na\_interpolation}\NormalTok{(cleaned\_data[, id\_of\_ts])}
  \CommentTok{\# monthly.ts \textless{}{-} apply.monthly(as.xts(cleaned\_data[, id\_of\_ts], order.by = as.Date(cleaned\_data$Date)), sum) \# If time steps are shorter than a month, sum them up to month granularity}

  \CommentTok{\# Generate a sequence of the first day of each month between the start and end dates}
\NormalTok{  start\_date }\OtherTok{\textless{}{-}} \FunctionTok{floor\_date}\NormalTok{(}\FunctionTok{min}\NormalTok{(cleaned\_data}\SpecialCharTok{$}\NormalTok{Date), }\StringTok{"month"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{months}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\NormalTok{  end\_date }\OtherTok{\textless{}{-}} \FunctionTok{ceiling\_date}\NormalTok{(}\FunctionTok{max}\NormalTok{(cleaned\_data}\SpecialCharTok{$}\NormalTok{Date), }\StringTok{"month"}\NormalTok{)}
\NormalTok{  date\_seq\_first }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\AttributeTok{from =}\NormalTok{ start\_date, }\AttributeTok{to =}\NormalTok{ end\_date, }\AttributeTok{by =} \StringTok{"month"}\NormalTok{)}

  \CommentTok{\# Adjust to the last day of each month and create a new dataframe with this sequence}
\NormalTok{  date\_seq\_last }\OtherTok{\textless{}{-}}\NormalTok{ date\_seq\_first }\SpecialCharTok{{-}} \FunctionTok{days}\NormalTok{(}\DecValTok{1}\NormalTok{)}

  \CommentTok{\# Merge with the original, keeping all dates}
\NormalTok{  monthly\_df }\OtherTok{\textless{}{-}} \FunctionTok{merge}\NormalTok{(}\FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Date =}\NormalTok{ date\_seq\_last), cleaned\_data, }\AttributeTok{by =} \StringTok{"Date"}\NormalTok{, }\AttributeTok{all.x =} \ConstantTok{TRUE}\NormalTok{)}

  \CommentTok{\# Interpolate the missing USGDPGR values using linear interpolation}
\NormalTok{  monthly\_df}\SpecialCharTok{$}\NormalTok{USGDPGR }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(}\FunctionTok{na.approx}\NormalTok{(monthly\_df}\SpecialCharTok{$}\NormalTok{USGDPGR, }\AttributeTok{na.rm =} \ConstantTok{FALSE}\NormalTok{), }\DecValTok{1}\NormalTok{)}
\NormalTok{  monthly.ts }\OtherTok{\textless{}{-}} \FunctionTok{ts}\NormalTok{(monthly\_df[, id\_of\_ts], }\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\FunctionTok{year}\NormalTok{(}\FunctionTok{min}\NormalTok{(monthly\_df}\SpecialCharTok{$}\NormalTok{Date)), }\FunctionTok{month}\NormalTok{(}\FunctionTok{min}\NormalTok{(monthly\_df}\SpecialCharTok{$}\NormalTok{Date))), }\AttributeTok{frequency =} \DecValTok{12}\NormalTok{)}
\NormalTok{  monthly.ts.original }\OtherTok{\textless{}{-}}\NormalTok{ monthly.ts}
  \CommentTok{\# imputed \textless{}{-} vector(length = nrow(monthly.ts))}

  \CommentTok{\# for(aux in 1:nrow(monthly.ts)) \{}
  \CommentTok{\#   if(as.numeric(monthly.ts[aux]) \textless{} X) \{ \# Impute based on the following rows if the value is under X}
  \CommentTok{\#     if(aux \textgreater{} 24) \{ \# Impute the average of the sum of one year ago (12) and two years ago (24) if we are over 24 months from the start of the time series}
  \CommentTok{\#       if((as.numeric(monthly.ts.original[aux {-} 12]) + as.numeric(monthly.ts.original[aux {-} 24])) / 2 \textgreater{} as.numeric(monthly.ts.original[aux])) \{}
  \CommentTok{\#         monthly.ts[aux] \textless{}{-} (as.numeric(monthly.ts.original[aux {-} 12]) + as.numeric(monthly.ts.original[aux {-} 24])) / 2}
  \CommentTok{\#         imputed[aux] \textless{}{-} 2}
  \CommentTok{\#       \}}
  \CommentTok{\#     \} else if(aux \textgreater{} 12) \{ \# Impute the value from one year ago if we are over 12 months from the start of the time series}
  \CommentTok{\#       if(as.numeric(monthly.ts.original[aux {-} 12]) \textgreater{} as.numeric(monthly.ts.original[aux])) \{}
  \CommentTok{\#         monthly.ts[aux] \textless{}{-} as.numeric(monthly.ts.original[aux {-} 12])}
  \CommentTok{\#         imputed[aux] \textless{}{-} 1}
  \CommentTok{\#       \}}
  \CommentTok{\#     \} else if(as.numeric(monthly.ts.original[aux]) \textless{} 10) \{ \# If within 12 months from the start, impute Y}
  \CommentTok{\#       monthly.ts[aux] \textless{}{-} Y}
  \CommentTok{\#       imputed[aux] \textless{}{-} 3}
  \CommentTok{\#     \}}
  \CommentTok{\#   \}}
  \CommentTok{\#   if(as.numeric(monthly.ts[aux]) == 0) \{ \# Impute 1 if the value is 0}
  \CommentTok{\#       monthly.ts[aux] \textless{}{-} 1}
  \CommentTok{\#       imputed[aux] \textless{}{-} 4}
  \CommentTok{\#   \}}
  \CommentTok{\# \}}
  \CommentTok{\# If a filename was given, print out the imputation information in a file. }
  \CommentTok{\# if (!is.null(imputations.output.filename)) \{}
  \CommentTok{\#   monthly.ts.for.printing \textless{}{-} cbind(monthly.ts, imputed)}
  \CommentTok{\#   colnames(monthly.ts.for.printing) \textless{}{-}  c(id\_of\_ts, "Imputed")}
  \CommentTok{\#   print(monthly.ts.for.printing)}
  \CommentTok{\#   sink(file = paste("imputations.txt", sep = "\_"), append = TRUE)}
  \CommentTok{\#   print(paste(id\_of\_ts))}
  \CommentTok{\#   print(monthly.ts.for.printing)}
  \CommentTok{\#   sink()}
  \CommentTok{\# \}}
  
\NormalTok{  list.ts }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(monthly.ts, monthly.ts.original)}
  \FunctionTok{return}\NormalTok{(list.ts)}
\NormalTok{\}}

\NormalTok{train\_ts\_models }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(ts\_train, id\_of\_ts, skipTimeConsumingAlgorithmsFlag)\{}
\DocumentationTok{\#\#\# Trains the eight models with the training data.}
\DocumentationTok{\#\#\# Parameters:}
\DocumentationTok{\#\#\# ts\_train: The time series object.}
  
\NormalTok{  list\_mod }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}
  
\NormalTok{  list\_mod[[}\StringTok{"TSLM.s"}\NormalTok{]] }\OtherTok{\textless{}{-}} \FunctionTok{tryCatch}\NormalTok{(\{}
    \FunctionTok{tslm}\NormalTok{(ts\_train }\SpecialCharTok{\textasciitilde{}}\NormalTok{ season, }\AttributeTok{lambda=}\StringTok{"auto"}\NormalTok{)}
\NormalTok{  \},}
  \AttributeTok{error=}\ControlFlowTok{function}\NormalTok{(cond)\{}
    \FunctionTok{message}\NormalTok{(cond)}
    \ControlFlowTok{if}\NormalTok{(}\FunctionTok{length}\NormalTok{(ts\_train) }\SpecialCharTok{\textless{}} \DecValTok{24}\NormalTok{) \{}
\NormalTok{      start }\OtherTok{\textless{}{-}} \FunctionTok{start}\NormalTok{(ts\_train) }\SpecialCharTok{{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, (}\DecValTok{24} \SpecialCharTok{{-}} \FunctionTok{length}\NormalTok{(ts\_train)))}
\NormalTok{    \}}
    \ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{      start }\OtherTok{\textless{}{-}} \FunctionTok{start}\NormalTok{(ts\_train)}
\NormalTok{    \}}
    \FunctionTok{tslm}\NormalTok{(}\FunctionTok{ts}\NormalTok{(}\FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{length}\NormalTok{(ts\_train)), }\AttributeTok{start =}\NormalTok{ start, }\AttributeTok{end =} \FunctionTok{end}\NormalTok{(ts\_train), }\AttributeTok{frequency =} \FunctionTok{frequency}\NormalTok{(ts\_train)) }\SpecialCharTok{\textasciitilde{}}\NormalTok{ season, }\AttributeTok{lambda=}\StringTok{"auto"}\NormalTok{)}
\NormalTok{  \}}
\NormalTok{  )}
  
  \FunctionTok{flog.info}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(id\_of\_ts, }\StringTok{": "}\NormalTok{, }\StringTok{"Seasonal regression trained"}\NormalTok{))}
  
\NormalTok{  list\_mod[[}\StringTok{"TSLM.st"}\NormalTok{]] }\OtherTok{\textless{}{-}} \FunctionTok{tryCatch}\NormalTok{(\{}
    \FunctionTok{tslm}\NormalTok{(ts\_train }\SpecialCharTok{\textasciitilde{}}\NormalTok{ trend }\SpecialCharTok{+}\NormalTok{ season, }\AttributeTok{lambda=}\StringTok{"auto"}\NormalTok{)}
\NormalTok{  \},}
  \AttributeTok{error=}\ControlFlowTok{function}\NormalTok{(cond)\{}
    \FunctionTok{message}\NormalTok{(cond) }
    \ControlFlowTok{if}\NormalTok{(}\FunctionTok{length}\NormalTok{(ts\_train) }\SpecialCharTok{\textless{}} \DecValTok{24}\NormalTok{) start }\OtherTok{\textless{}{-}} \FunctionTok{start}\NormalTok{(ts\_train) }\SpecialCharTok{{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, (}\DecValTok{24} \SpecialCharTok{{-}} \FunctionTok{length}\NormalTok{(ts\_train)))}
    \ControlFlowTok{else}\NormalTok{ start }\OtherTok{\textless{}{-}} \FunctionTok{start}\NormalTok{(ts\_train)}
    \FunctionTok{tslm}\NormalTok{(}\FunctionTok{ts}\NormalTok{(}\FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{length}\NormalTok{(ts\_train)), }\AttributeTok{start =}\NormalTok{ start, }\AttributeTok{end =} \FunctionTok{end}\NormalTok{(ts\_train), }\AttributeTok{frequency =} \FunctionTok{frequency}\NormalTok{(ts\_train)) }\SpecialCharTok{\textasciitilde{}}\NormalTok{ trend }\SpecialCharTok{+}\NormalTok{ season, }\AttributeTok{lambda=}\StringTok{"auto"}\NormalTok{)}
\NormalTok{  \}}
\NormalTok{  )}

  \FunctionTok{flog.info}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(id\_of\_ts, }\StringTok{": "}\NormalTok{, }\StringTok{"Trend + Seasonal regression trained"}\NormalTok{))}

\NormalTok{  list\_mod[[}\StringTok{"HW.mul"}\NormalTok{]] }\OtherTok{\textless{}{-}} \FunctionTok{tryCatch}\NormalTok{(\{}
    \FunctionTok{HoltWinters}\NormalTok{(ts\_train, }\AttributeTok{seasonal =} \StringTok{"mul"}\NormalTok{)}
\NormalTok{  \},}
  \AttributeTok{error=}\ControlFlowTok{function}\NormalTok{(cond)\{}
    \FunctionTok{message}\NormalTok{(cond)}
    \ControlFlowTok{if}\NormalTok{(}\FunctionTok{length}\NormalTok{(ts\_train) }\SpecialCharTok{\textless{}} \DecValTok{24}\NormalTok{) start }\OtherTok{\textless{}{-}} \FunctionTok{start}\NormalTok{(ts\_train) }\SpecialCharTok{{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, (}\DecValTok{24} \SpecialCharTok{{-}} \FunctionTok{length}\NormalTok{(ts\_train)))}
    \ControlFlowTok{else}\NormalTok{ start }\OtherTok{\textless{}{-}} \FunctionTok{start}\NormalTok{(ts\_train)}
    \FunctionTok{HoltWinters}\NormalTok{(}\FunctionTok{ts}\NormalTok{(}\FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{length}\NormalTok{(ts\_train)), }\AttributeTok{start =}\NormalTok{ start, }\AttributeTok{end =} \FunctionTok{end}\NormalTok{(ts\_train), }\AttributeTok{frequency =} \FunctionTok{frequency}\NormalTok{(ts\_train)))}
\NormalTok{  \}}
\NormalTok{  )}

  \FunctionTok{flog.info}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(id\_of\_ts, }\StringTok{": "}\NormalTok{, }\StringTok{"Holt{-}Winters multiplicative trained"}\NormalTok{))}

\NormalTok{  list\_mod[[}\StringTok{"HW.add"}\NormalTok{]] }\OtherTok{\textless{}{-}} \FunctionTok{tryCatch}\NormalTok{(\{}
    \FunctionTok{HoltWinters}\NormalTok{(ts\_train, }\AttributeTok{seasonal =} \StringTok{"add"}\NormalTok{)}
\NormalTok{  \},}
  \AttributeTok{error=}\ControlFlowTok{function}\NormalTok{(cond)\{}
    \FunctionTok{message}\NormalTok{(cond)}
    \ControlFlowTok{if}\NormalTok{(}\FunctionTok{length}\NormalTok{(ts\_train) }\SpecialCharTok{\textless{}} \DecValTok{24}\NormalTok{) start }\OtherTok{\textless{}{-}} \FunctionTok{start}\NormalTok{(ts\_train) }\SpecialCharTok{{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, (}\DecValTok{24} \SpecialCharTok{{-}} \FunctionTok{length}\NormalTok{(ts\_train)))}
    \ControlFlowTok{else}\NormalTok{ start }\OtherTok{\textless{}{-}} \FunctionTok{start}\NormalTok{(ts\_train)}
    \FunctionTok{HoltWinters}\NormalTok{(}\FunctionTok{ts}\NormalTok{(}\FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{length}\NormalTok{(ts\_train)), }\AttributeTok{start =}\NormalTok{ start, }\AttributeTok{end =} \FunctionTok{end}\NormalTok{(ts\_train), }\AttributeTok{frequency =} \FunctionTok{frequency}\NormalTok{(ts\_train)))}
\NormalTok{  \}}
\NormalTok{  )}

  \FunctionTok{flog.info}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(id\_of\_ts, }\StringTok{": "}\NormalTok{, }\StringTok{"Holt{-}Winters additive trained"}\NormalTok{))}
  
  \ControlFlowTok{if}\NormalTok{(}\SpecialCharTok{!}\NormalTok{skipTimeConsumingAlgorithmsFlag) \{}
\NormalTok{    list\_mod[[}\StringTok{"ARIMA"}\NormalTok{]] }\OtherTok{\textless{}{-}} \FunctionTok{tryCatch}\NormalTok{(\{}
      \FunctionTok{auto.arima}\NormalTok{(ts\_train, }\AttributeTok{max.p=}\DecValTok{2}\NormalTok{, }\AttributeTok{max.q=}\DecValTok{2}\NormalTok{,}
                 \AttributeTok{max.P=}\DecValTok{2}\NormalTok{, }\AttributeTok{max.Q=}\DecValTok{2}\NormalTok{, }\AttributeTok{max.d=}\DecValTok{1}\NormalTok{, }\AttributeTok{max.D=}\DecValTok{1}\NormalTok{, }\AttributeTok{allowdrift =} \ConstantTok{TRUE}\NormalTok{,}
                 \AttributeTok{stepwise=}\ConstantTok{FALSE}\NormalTok{, }\AttributeTok{approximation=}\ConstantTok{FALSE}\NormalTok{,}
                 \AttributeTok{ic =} \StringTok{"bic"}\NormalTok{,  }\AttributeTok{parallel =} \StringTok{"TRUE"}\NormalTok{)}
\NormalTok{    \},}
    \AttributeTok{error=}\ControlFlowTok{function}\NormalTok{(cond)\{}
      \FunctionTok{message}\NormalTok{(cond)}
      \FunctionTok{return}\NormalTok{(}\ConstantTok{NA}\NormalTok{)}
\NormalTok{    \}}
\NormalTok{    )}
  
    \FunctionTok{flog.info}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(id\_of\_ts, }\StringTok{": "}\NormalTok{, }\StringTok{"ARIMA trained"}\NormalTok{))}
  
\NormalTok{    list\_mod[[}\StringTok{"ARIMA.boxcox"}\NormalTok{]] }\OtherTok{\textless{}{-}} \FunctionTok{tryCatch}\NormalTok{(\{}
      \FunctionTok{auto.arima}\NormalTok{(ts\_train, }\AttributeTok{max.p=}\DecValTok{2}\NormalTok{, }\AttributeTok{max.q=}\DecValTok{2}\NormalTok{,}
                 \AttributeTok{max.P=}\DecValTok{2}\NormalTok{, }\AttributeTok{max.Q=}\DecValTok{2}\NormalTok{, }\AttributeTok{max.d=}\DecValTok{1}\NormalTok{, }\AttributeTok{max.D=}\DecValTok{1}\NormalTok{, }\AttributeTok{allowdrift =} \ConstantTok{TRUE}\NormalTok{,}
                 \AttributeTok{stepwise=}\ConstantTok{FALSE}\NormalTok{, }\AttributeTok{approximation=}\ConstantTok{FALSE}\NormalTok{, }\AttributeTok{lambda=}\StringTok{"auto"}\NormalTok{,}
                 \AttributeTok{ic =} \StringTok{"bic"}\NormalTok{, }\AttributeTok{parallel =} \StringTok{"TRUE"}\NormalTok{)}
\NormalTok{    \},}
    \AttributeTok{error=}\ControlFlowTok{function}\NormalTok{(cond)\{}
  
      \FunctionTok{return}\NormalTok{(}\ConstantTok{NA}\NormalTok{)}
\NormalTok{    \}}
\NormalTok{    )}
  
    \FunctionTok{flog.info}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(id\_of\_ts, }\StringTok{": "}\NormalTok{, }\StringTok{"ARIMA with boxcox trained"}\NormalTok{))}
  
\NormalTok{    list\_mod[[}\StringTok{"ets"}\NormalTok{]] }\OtherTok{\textless{}{-}} \FunctionTok{tryCatch}\NormalTok{(\{}
      \FunctionTok{ets}\NormalTok{(ts\_train, }\AttributeTok{model=}\StringTok{"ZZZ"}\NormalTok{, }\AttributeTok{lambda =} \StringTok{"auto"}\NormalTok{, }\AttributeTok{bounds =} \StringTok{"both"}\NormalTok{)}
\NormalTok{    \},}
    \AttributeTok{error=}\ControlFlowTok{function}\NormalTok{(cond)\{}
      \FunctionTok{message}\NormalTok{(cond)}
      \FunctionTok{return}\NormalTok{(}\ConstantTok{NA}\NormalTok{)}
\NormalTok{    \}}
\NormalTok{    )}
  
    \FunctionTok{flog.info}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(id\_of\_ts, }\StringTok{": "}\NormalTok{, }\StringTok{"ETS trained"}\NormalTok{))}
  
\NormalTok{    list\_mod[[}\StringTok{"tbats"}\NormalTok{]] }\OtherTok{\textless{}{-}} \FunctionTok{tryCatch}\NormalTok{(\{}
      \FunctionTok{tbats}\NormalTok{(ts\_train, }\AttributeTok{use.box.cox =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{use.trend =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{use.damped.trend =} \ConstantTok{NULL}\NormalTok{,}
            \AttributeTok{seasonal.periods =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{use.arma.errors =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{    \},}
    \AttributeTok{error=}\ControlFlowTok{function}\NormalTok{(cond)\{}
      \FunctionTok{message}\NormalTok{(cond)}
      \FunctionTok{return}\NormalTok{(}\ConstantTok{NA}\NormalTok{)}
\NormalTok{    \}}
\NormalTok{    )}
  
    \FunctionTok{flog.info}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(id\_of\_ts, }\StringTok{": "}\NormalTok{, }\StringTok{"TBATS trained"}\NormalTok{))}
\NormalTok{  \}}
  \FunctionTok{return}\NormalTok{(list\_mod)}
\NormalTok{\}}


\NormalTok{forecast\_with\_external\_regressors }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(mod, ts\_disruption\_train, n)\{}
  \FunctionTok{tryCatch}\NormalTok{(\{}
    \FunctionTok{forecast}\NormalTok{(mod, }\AttributeTok{xreg =}\NormalTok{ ts\_disruption\_train, }\AttributeTok{h =}\NormalTok{ n)}\SpecialCharTok{$}\NormalTok{mean[}\DecValTok{1}\NormalTok{]}
\NormalTok{  \},}
  \AttributeTok{error=}\ControlFlowTok{function}\NormalTok{(cond)\{}
    \FunctionTok{message}\NormalTok{(cond)}
    \FunctionTok{return}\NormalTok{(}\DecValTok{0}\NormalTok{)}
\NormalTok{  \}}
\NormalTok{  )}
\NormalTok{\}}


\NormalTok{forecast\_without\_external\_regressors }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(mod, n)\{}
  \FunctionTok{tryCatch}\NormalTok{(\{}
    \FunctionTok{na\_replace}\NormalTok{(}\FunctionTok{forecast}\NormalTok{(mod, }\AttributeTok{h =} \FunctionTok{max}\NormalTok{(n))}\SpecialCharTok{$}\NormalTok{mean) }\CommentTok{\# Replace NA\textquotesingle{}s with zeros.}
\NormalTok{  \},}
  \AttributeTok{error=}\ControlFlowTok{function}\NormalTok{(cond)\{}
    \FunctionTok{message}\NormalTok{(cond)}
    \FunctionTok{return}\NormalTok{()}
\NormalTok{  \}}
\NormalTok{  )}
\NormalTok{\}}

\NormalTok{predict\_ts\_models }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(list\_mod, ts\_val, forecasts\_per\_month, step, total\_steps, months.ahead, id\_of\_ts, skipTimeConsumingAlgorithmsFlag)\{}
\DocumentationTok{\#\#\# Makes forecasts for each step by calling a function, which makes forecasts and creates a data frame with monthly forecasts from each model.}
\DocumentationTok{\#\#\# Parameters:}
\DocumentationTok{\#\#\# list\_mod: A list containing all the trained models.}
\DocumentationTok{\#\#\# ts\_val: The time series.}
\DocumentationTok{\#\#\# forecasts\_per\_month:}
\DocumentationTok{\#\#\# total\_steps: }
\DocumentationTok{\#\#\# months.ahead: The months ahead to be forecasted as a vector. 1 is the current (incomplete) month.}
\DocumentationTok{\#\#\# Returns: }
  \ControlFlowTok{if}\NormalTok{(skipTimeConsumingAlgorithmsFlag) \{}
\NormalTok{  names }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Reg.seasonal"}\NormalTok{, }\StringTok{"Reg.trend.seasonal"}\NormalTok{,}
             \StringTok{"HW.Mul"}\NormalTok{, }\StringTok{"HW.Add"}
             \CommentTok{\# , "ARIMA", "ARIMA.boxcox"}
             \CommentTok{\# , "ETS", "TBATS"}
\NormalTok{             , }\StringTok{"Naive.prev.year"}\CommentTok{\#, "Naive.prev.datapoint"}
\NormalTok{             )}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{    names }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Reg.seasonal"}\NormalTok{, }\StringTok{"Reg.trend.seasonal"}\NormalTok{,}
               \StringTok{"HW.Mul"}\NormalTok{, }\StringTok{"HW.Add"}
\NormalTok{               , }\StringTok{"ARIMA"}\NormalTok{, }\StringTok{"ARIMA.boxcox"}
\NormalTok{               , }\StringTok{"ETS"}\NormalTok{, }\StringTok{"TBATS"}
\NormalTok{               , }\StringTok{"Naive.prev.year"}\CommentTok{\#, "Naive.prev.datapoint"}
\NormalTok{    )}
\NormalTok{  \}}
  
  
\NormalTok{  no\_of\_naive\_models }\OtherTok{\textless{}{-}} \DecValTok{1}
  \CommentTok{\# no\_of\_naive\_models \textless{}{-} 2}
  \ControlFlowTok{for}\NormalTok{(j }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{(}\FunctionTok{length}\NormalTok{(list\_mod) }\SpecialCharTok{+}\NormalTok{ no\_of\_naive\_models)) \{}
    \CommentTok{\# j \textless{}{-} 6}
    \ControlFlowTok{if}\NormalTok{ (j }\SpecialCharTok{\textless{}=} \FunctionTok{length}\NormalTok{(list\_mod)) \{}
\NormalTok{      one\_month\_forecast }\OtherTok{\textless{}{-}} \FunctionTok{forecast\_without\_external\_regressors}\NormalTok{(}\AttributeTok{mod =}\NormalTok{ list\_mod[[j]], }\AttributeTok{n =}\NormalTok{ months.ahead)}
      \FunctionTok{flog.info}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(id\_of\_ts, }\StringTok{":"}\NormalTok{), }\StringTok{"Predictions made for"}\NormalTok{, }\FunctionTok{class}\NormalTok{(list\_mod[[j]])[}\DecValTok{1}\NormalTok{], }\FunctionTok{as.Date}\NormalTok{(}\FunctionTok{as.yearmon}\NormalTok{(}\FunctionTok{time}\NormalTok{(one\_month\_forecast)))))}
\NormalTok{    \} }\ControlFlowTok{else}\NormalTok{ \{ }\CommentTok{\# Lastly, do the naive forecasts.}
          \ControlFlowTok{if}\NormalTok{(j }\SpecialCharTok{==} \FunctionTok{length}\NormalTok{(list\_mod)}\SpecialCharTok{+}\DecValTok{1}\NormalTok{) \{}
\NormalTok{            aux }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(}\FunctionTok{data.frame}\NormalTok{(}\StringTok{"Y"} \OtherTok{=}\NormalTok{ forecasts\_per\_month[forecasts\_per\_month}\SpecialCharTok{$}\NormalTok{model }\SpecialCharTok{==} \StringTok{"Base"} \SpecialCharTok{\&}\NormalTok{ forecasts\_per\_month}\SpecialCharTok{$}\NormalTok{date }\SpecialCharTok{==} \FunctionTok{max}\NormalTok{(}\FunctionTok{subset}\NormalTok{(forecasts\_per\_month, type }\SpecialCharTok{==} \StringTok{"1\_ahead"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{date) }\SpecialCharTok{{-}} \FunctionTok{years}\NormalTok{(}\DecValTok{1}\NormalTok{), }\DecValTok{1}\NormalTok{], }\AttributeTok{date =} \FunctionTok{max}\NormalTok{(}\FunctionTok{subset}\NormalTok{(forecasts\_per\_month, type }\SpecialCharTok{==} \StringTok{"1\_ahead"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{date)), }\FunctionTok{data.frame}\NormalTok{(}\StringTok{"Y"} \OtherTok{=}\NormalTok{ forecasts\_per\_month[forecasts\_per\_month}\SpecialCharTok{$}\NormalTok{model }\SpecialCharTok{==} \StringTok{"Base"} \SpecialCharTok{\&}\NormalTok{ forecasts\_per\_month}\SpecialCharTok{$}\NormalTok{date }\SpecialCharTok{==} \FunctionTok{max}\NormalTok{(}\FunctionTok{subset}\NormalTok{(forecasts\_per\_month, type }\SpecialCharTok{==} \StringTok{"2\_ahead"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{date) }\SpecialCharTok{{-}} \FunctionTok{years}\NormalTok{(}\DecValTok{1}\NormalTok{), }\DecValTok{1}\NormalTok{], }\AttributeTok{date =} \FunctionTok{max}\NormalTok{(}\FunctionTok{subset}\NormalTok{(forecasts\_per\_month, type }\SpecialCharTok{==} \StringTok{"2\_ahead"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{date)), }\FunctionTok{data.frame}\NormalTok{(}\StringTok{"Y"} \OtherTok{=}\NormalTok{ forecasts\_per\_month[forecasts\_per\_month}\SpecialCharTok{$}\NormalTok{model }\SpecialCharTok{==} \StringTok{"Base"} \SpecialCharTok{\&}\NormalTok{ forecasts\_per\_month}\SpecialCharTok{$}\NormalTok{date }\SpecialCharTok{==} \FunctionTok{max}\NormalTok{(}\FunctionTok{subset}\NormalTok{(forecasts\_per\_month, type }\SpecialCharTok{==} \StringTok{"3\_ahead"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{date) }\SpecialCharTok{{-}} \FunctionTok{years}\NormalTok{(}\DecValTok{1}\NormalTok{), }\DecValTok{1}\NormalTok{], }\AttributeTok{date =} \FunctionTok{max}\NormalTok{(}\FunctionTok{subset}\NormalTok{(forecasts\_per\_month, type }\SpecialCharTok{==} \StringTok{"3\_ahead"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{date)), }\FunctionTok{data.frame}\NormalTok{(}\StringTok{"Y"} \OtherTok{=}\NormalTok{ forecasts\_per\_month[forecasts\_per\_month}\SpecialCharTok{$}\NormalTok{model }\SpecialCharTok{==} \StringTok{"Base"} \SpecialCharTok{\&}\NormalTok{ forecasts\_per\_month}\SpecialCharTok{$}\NormalTok{date }\SpecialCharTok{==} \FunctionTok{max}\NormalTok{(}\FunctionTok{subset}\NormalTok{(forecasts\_per\_month, type }\SpecialCharTok{==} \StringTok{"4\_ahead"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{date) }\SpecialCharTok{{-}} \FunctionTok{years}\NormalTok{(}\DecValTok{1}\NormalTok{), }\DecValTok{1}\NormalTok{], }\AttributeTok{date =} \FunctionTok{max}\NormalTok{(}\FunctionTok{subset}\NormalTok{(forecasts\_per\_month, type }\SpecialCharTok{==} \StringTok{"4\_ahead"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{date)))}
\NormalTok{          \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{            aux }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(}\FunctionTok{data.frame}\NormalTok{(}\StringTok{"Y"} \OtherTok{=}\NormalTok{ forecasts\_per\_month[forecasts\_per\_month}\SpecialCharTok{$}\NormalTok{model }\SpecialCharTok{==} \StringTok{"Base"} \SpecialCharTok{\&}\NormalTok{ forecasts\_per\_month}\SpecialCharTok{$}\NormalTok{date }\SpecialCharTok{==} \FunctionTok{max}\NormalTok{(}\FunctionTok{subset}\NormalTok{(forecasts\_per\_month, type }\SpecialCharTok{==} \StringTok{"1\_ahead"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{date) }\SpecialCharTok{\%m{-}\%} \FunctionTok{months}\NormalTok{(}\DecValTok{1}\NormalTok{), }\DecValTok{1}\NormalTok{], }\AttributeTok{date =} \FunctionTok{max}\NormalTok{(}\FunctionTok{subset}\NormalTok{(forecasts\_per\_month, type }\SpecialCharTok{==} \StringTok{"1\_ahead"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{date)), }\FunctionTok{data.frame}\NormalTok{(}\StringTok{"Y"} \OtherTok{=}\NormalTok{ forecasts\_per\_month[forecasts\_per\_month}\SpecialCharTok{$}\NormalTok{model }\SpecialCharTok{==} \StringTok{"Base"} \SpecialCharTok{\&}\NormalTok{ forecasts\_per\_month}\SpecialCharTok{$}\NormalTok{date }\SpecialCharTok{==} \FunctionTok{max}\NormalTok{(}\FunctionTok{subset}\NormalTok{(forecasts\_per\_month, type }\SpecialCharTok{==} \StringTok{"1\_ahead"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{date) }\SpecialCharTok{\%m{-}\%} \FunctionTok{months}\NormalTok{(}\DecValTok{1}\NormalTok{), }\DecValTok{1}\NormalTok{], }\AttributeTok{date =} \FunctionTok{max}\NormalTok{(}\FunctionTok{subset}\NormalTok{(forecasts\_per\_month, type }\SpecialCharTok{==} \StringTok{"2\_ahead"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{date)), }\FunctionTok{data.frame}\NormalTok{(}\StringTok{"Y"} \OtherTok{=}\NormalTok{ forecasts\_per\_month[forecasts\_per\_month}\SpecialCharTok{$}\NormalTok{model }\SpecialCharTok{==} \StringTok{"Base"} \SpecialCharTok{\&}\NormalTok{ forecasts\_per\_month}\SpecialCharTok{$}\NormalTok{date }\SpecialCharTok{==} \FunctionTok{max}\NormalTok{(}\FunctionTok{subset}\NormalTok{(forecasts\_per\_month, type }\SpecialCharTok{==} \StringTok{"1\_ahead"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{date) }\SpecialCharTok{\%m{-}\%} \FunctionTok{months}\NormalTok{(}\DecValTok{1}\NormalTok{), }\DecValTok{1}\NormalTok{], }\AttributeTok{date =} \FunctionTok{max}\NormalTok{(}\FunctionTok{subset}\NormalTok{(forecasts\_per\_month, type }\SpecialCharTok{==} \StringTok{"3\_ahead"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{date)), }\FunctionTok{data.frame}\NormalTok{(}\StringTok{"Y"} \OtherTok{=}\NormalTok{ forecasts\_per\_month[forecasts\_per\_month}\SpecialCharTok{$}\NormalTok{model }\SpecialCharTok{==} \StringTok{"Base"} \SpecialCharTok{\&}\NormalTok{ forecasts\_per\_month}\SpecialCharTok{$}\NormalTok{date }\SpecialCharTok{==} \FunctionTok{max}\NormalTok{(}\FunctionTok{subset}\NormalTok{(forecasts\_per\_month, type }\SpecialCharTok{==} \StringTok{"1\_ahead"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{date) }\SpecialCharTok{\%m{-}\%} \FunctionTok{months}\NormalTok{(}\DecValTok{1}\NormalTok{), }\DecValTok{1}\NormalTok{], }\AttributeTok{date =} \FunctionTok{max}\NormalTok{(}\FunctionTok{subset}\NormalTok{(forecasts\_per\_month, type }\SpecialCharTok{==} \StringTok{"4\_ahead"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{date)))}
\NormalTok{        \}}
\NormalTok{        ts.forecast }\OtherTok{\textless{}{-}} \FunctionTok{as.xts}\NormalTok{(aux}\SpecialCharTok{$}\NormalTok{Y, }\AttributeTok{order.by =} \FunctionTok{as.Date}\NormalTok{(aux}\SpecialCharTok{$}\NormalTok{date))}
\NormalTok{        ts.all }\OtherTok{\textless{}{-}} \FunctionTok{ts}\NormalTok{(ts.forecast, }\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\FunctionTok{year}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(}\FunctionTok{time}\NormalTok{(ts.forecast))[}\DecValTok{1}\NormalTok{]), }\FunctionTok{month}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(}\FunctionTok{time}\NormalTok{(ts.forecast))[}\DecValTok{1}\NormalTok{]), }\FunctionTok{week}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(}\FunctionTok{time}\NormalTok{(ts.forecast))[}\DecValTok{1}\NormalTok{])), }
                     \AttributeTok{end =} \FunctionTok{c}\NormalTok{(}\FunctionTok{year}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(}\FunctionTok{time}\NormalTok{(ts.forecast))[}\FunctionTok{length}\NormalTok{(ts.forecast)]), }\FunctionTok{month}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(}\FunctionTok{time}\NormalTok{(ts.forecast))[}\FunctionTok{length}\NormalTok{(ts.forecast)]), }
                     \FunctionTok{week}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(}\FunctionTok{time}\NormalTok{(ts.forecast))[}\FunctionTok{length}\NormalTok{(ts.forecast)])), }
                     \AttributeTok{frequency =} \DecValTok{12}\NormalTok{)}
\NormalTok{        one\_month\_forecast }\OtherTok{\textless{}{-}}\NormalTok{ ts.all}
        \FunctionTok{flog.info}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(id\_of\_ts, }\StringTok{":"}\NormalTok{), }\StringTok{"Predictions made for Naive no "}\NormalTok{, j }\SpecialCharTok{{-}} \DecValTok{4}\NormalTok{, }\FunctionTok{as.Date}\NormalTok{(}\FunctionTok{as.yearmon}\NormalTok{(}\FunctionTok{time}\NormalTok{(one\_month\_forecast)))))}
\NormalTok{      \}}
        
\NormalTok{    p }\OtherTok{\textless{}{-}} \DecValTok{1}
    \ControlFlowTok{for}\NormalTok{(p }\ControlFlowTok{in}\NormalTok{ months.ahead)\{}
      \ControlFlowTok{if}\NormalTok{((step}\SpecialCharTok{+}\NormalTok{p}\DecValTok{{-}1}\NormalTok{) }\SpecialCharTok{\textless{}}\NormalTok{ total\_steps)\{}
\NormalTok{        forecasts\_per\_month }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(forecasts\_per\_month, }\FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Y=}\FunctionTok{as.matrix}\NormalTok{(one\_month\_forecast[p]), }\AttributeTok{date=}\FunctionTok{as.Date}\NormalTok{(}\FunctionTok{as.yearmon}\NormalTok{(}\FunctionTok{time}\NormalTok{(one\_month\_forecast)[p])), }\AttributeTok{model =}\NormalTok{ names[j], }\AttributeTok{type =} \FunctionTok{paste0}\NormalTok{(p, }\StringTok{"\_ahead"}\NormalTok{)))}
        \FunctionTok{row.names}\NormalTok{(forecasts\_per\_month) }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, }\FunctionTok{nrow}\NormalTok{(forecasts\_per\_month), }\AttributeTok{by =} \DecValTok{1}\NormalTok{)}
\NormalTok{      \}}\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{(step }\SpecialCharTok{==}\NormalTok{ total\_steps)\{}
\NormalTok{        forecasts\_per\_month }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(forecasts\_per\_month, }\FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Y=}\FunctionTok{as.matrix}\NormalTok{(one\_month\_forecast[p]), }\AttributeTok{date=}\FunctionTok{as.Date}\NormalTok{(}\FunctionTok{as.yearmon}\NormalTok{(}\FunctionTok{time}\NormalTok{(one\_month\_forecast)[p])), }\AttributeTok{model =}\NormalTok{ names[j],}
                                                \AttributeTok{type =} \FunctionTok{paste0}\NormalTok{(p, }\StringTok{"\_ahead"}\NormalTok{)))}
        \FunctionTok{row.names}\NormalTok{(forecasts\_per\_month) }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, }\FunctionTok{nrow}\NormalTok{(forecasts\_per\_month), }\AttributeTok{by =} \DecValTok{1}\NormalTok{)}
\NormalTok{      \}}
\NormalTok{    \}}
\NormalTok{  \}}
  \FunctionTok{return}\NormalTok{(forecasts\_per\_month)}
\NormalTok{\}}

\NormalTok{create\_train\_test }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(start\_train, start\_test, ts.all, step, number.of.steps.in.test, months.ahead)\{}
\DocumentationTok{\#\#\# Creates the training and testing datasets.}
\DocumentationTok{\#\#\# Parameters:}
\DocumentationTok{\#\#\# start\_train: The start date of the training dataset.}
\DocumentationTok{\#\#\# start\_test: The start date of the testing dataset.}
\DocumentationTok{\#\#\# ts\_all: The time series.}
\DocumentationTok{\#\#\# step: The current step number, i.e., the current position of the "test set window".}
\DocumentationTok{\#\#\# number.of.steps.in.test: The total number of steps in the test set.}
\DocumentationTok{\#\#\# months.ahead: The months ahead to be forecasted as a vector. 1 is the current (incomplete) month.}
\DocumentationTok{\#\#\# Returns: A list with the given step\textquotesingle{}s training time series as the first element and the forecasts based on}
\DocumentationTok{\#\#\# that time series as the second element.}

\NormalTok{ts\_train }\OtherTok{\textless{}{-}} \FunctionTok{window}\NormalTok{(ts.all, }\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\FunctionTok{year}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(start\_train)), }\FunctionTok{month}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(start\_train))), }\AttributeTok{end =} \FunctionTok{c}\NormalTok{(}\FunctionTok{year}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(start\_test }\SpecialCharTok{+} \FunctionTok{months}\NormalTok{(step) }\SpecialCharTok{{-}} \FunctionTok{months}\NormalTok{(}\DecValTok{2}\NormalTok{))), }\FunctionTok{month}\NormalTok{(start\_test }\SpecialCharTok{+} \FunctionTok{months}\NormalTok{(step) }\SpecialCharTok{{-}} \FunctionTok{months}\NormalTok{(}\DecValTok{2}\NormalTok{))), }\AttributeTok{frequency =} \FunctionTok{frequency}\NormalTok{(ts.all))}

\NormalTok{  ts\_vsl\_list }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{() }\CommentTok{\# A list to hold the forecasts}
  \ControlFlowTok{for}\NormalTok{(j }\ControlFlowTok{in}\NormalTok{ months.ahead)\{}
    \CommentTok{\# j \textless{}{-} 1}
    \ControlFlowTok{if}\NormalTok{((step }\SpecialCharTok{+}\NormalTok{ j }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{) }\SpecialCharTok{\textless{}}\NormalTok{ number.of.steps.in.test)\{ }\CommentTok{\# If this step plus the number of months the current forecast is ahead is within the test set, i.e, not out{-}of{-}sample}
\NormalTok{      ts\_vsl\_list[j] }\OtherTok{\textless{}{-}} \FunctionTok{window}\NormalTok{(ts.all, }\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\FunctionTok{year}\NormalTok{(start\_test), }\FunctionTok{month}\NormalTok{(start\_test }\SpecialCharTok{+} \FunctionTok{months}\NormalTok{(step }\SpecialCharTok{+}\NormalTok{ j }\SpecialCharTok{{-}} \DecValTok{2}\NormalTok{))), }\AttributeTok{end =} \FunctionTok{c}\NormalTok{(}\FunctionTok{year}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(start\_test)), }\FunctionTok{month}\NormalTok{(start\_test }\SpecialCharTok{+} \FunctionTok{months}\NormalTok{(step }\SpecialCharTok{+}\NormalTok{ j }\SpecialCharTok{{-}} \DecValTok{2}\NormalTok{))), }\AttributeTok{frequency =} \FunctionTok{frequency}\NormalTok{(ts.all)) }
\NormalTok{    \} }\ControlFlowTok{else}\NormalTok{\{ }\CommentTok{\# If this step plus the number of months the current forecast is ahead is beyond the test set, i.e., out{-}of{-}sample}
      \CommentTok{\# ts\_vsl\_list[j] \textless{}{-} ts(0, frequency=frequency(ts.all), start=c(year(as.Date(start\_test)), month(as.Date(start\_test)) {-} 1 + step + (j {-} 1)))}
\NormalTok{      ts\_vsl\_list[j] }\OtherTok{\textless{}{-}} \FunctionTok{ts}\NormalTok{(}\DecValTok{0}\NormalTok{, }\AttributeTok{frequency =} \FunctionTok{frequency}\NormalTok{(ts.all), }\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\FunctionTok{year}\NormalTok{(start\_test), }\FunctionTok{month}\NormalTok{(start\_test }\SpecialCharTok{+} \FunctionTok{months}\NormalTok{(step }\SpecialCharTok{+}\NormalTok{ j }\SpecialCharTok{{-}} \DecValTok{2}\NormalTok{))))}
\NormalTok{    \}}
\NormalTok{  \}}
\NormalTok{  ts\_train }\OtherTok{\textless{}{-}} \FunctionTok{ifelse}\NormalTok{(ts\_train }\SpecialCharTok{==} \DecValTok{0}\NormalTok{, }\FloatTok{0.01}\NormalTok{, ts\_train)}

  \FunctionTok{return}\NormalTok{(}\FunctionTok{list}\NormalTok{(ts\_train, ts\_vsl\_list))}
\NormalTok{\}}


\NormalTok{split\_data\_and\_model\_monthly }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(dataFull, list.ts, id\_of\_ts, months.ahead, start\_test, start\_train, first.month.to.forecast, mape.output.filename, script.name, progressCounter, skipTimeConsumingAlgorithmsFlag)\{}
\DocumentationTok{\#\#\# Creates the training and testing datasets and trains the time series models. Calls a function that does the predictions and then a function that does evaluations.}
\DocumentationTok{\#\#\# Parameters:}
\DocumentationTok{\#\#\# list.ts: List with the time series. The first element is with the imputated values (no zeros ever) and the second with the original values.}
\DocumentationTok{\#\#\# months.ahead: The months ahead to be forecasted as a vector. 1 is the current (incomplete) month.}
\DocumentationTok{\#\#\# output.filename: The filename used for saving MAPEs.}
\DocumentationTok{\#\#\# Returns: The value given by the last forecast.}

  \CommentTok{\# Do the splits for training and test sets.}
  \ControlFlowTok{if}\NormalTok{(}\FunctionTok{exists}\NormalTok{(}\StringTok{"start\_train"}\NormalTok{))\{}
    \FunctionTok{rm}\NormalTok{(start\_train)}
    \FunctionTok{rm}\NormalTok{(start\_test)}
\NormalTok{  \}}

  \ControlFlowTok{if}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{exists}\NormalTok{(}\StringTok{"start\_train"}\NormalTok{))\{}
\NormalTok{    start\_train }\OtherTok{\textless{}{-}} \FunctionTok{min}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(}\FunctionTok{time}\NormalTok{(list.ts[[}\DecValTok{1}\NormalTok{]]))) }\CommentTok{\# What is the starting point in our entire time series for our training (and test) set}
\NormalTok{  \}}

  \ControlFlowTok{if}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{exists}\NormalTok{(}\StringTok{"start\_test"}\NormalTok{))\{}
\NormalTok{    start\_test }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(}\FunctionTok{time}\NormalTok{(list.ts[[}\DecValTok{1}\NormalTok{]]))[}\FunctionTok{round}\NormalTok{(}\FunctionTok{length}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(}\FunctionTok{time}\NormalTok{(list.ts[[}\DecValTok{1}\NormalTok{]])))}\SpecialCharTok{*}\FloatTok{0.7}\NormalTok{)] }\CommentTok{\# Our training set is 70\% and the 30\% after it is the test set}
\NormalTok{  \}}
  
  \ControlFlowTok{if}\NormalTok{(start\_train }\SpecialCharTok{\textless{}} \FunctionTok{min}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(}\FunctionTok{time}\NormalTok{(list.ts[[}\DecValTok{1}\NormalTok{]]))))\{}
\NormalTok{    start\_train }\OtherTok{\textless{}{-}} \FunctionTok{min}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(}\FunctionTok{time}\NormalTok{(list.ts[[}\DecValTok{1}\NormalTok{]])))}
\NormalTok{  \}}
  
\NormalTok{  ts.all }\OtherTok{\textless{}{-}} \FunctionTok{window}\NormalTok{(list.ts[[}\DecValTok{1}\NormalTok{]], }\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\FunctionTok{year}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(start\_train)), }\FunctionTok{month}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(start\_train))), }\AttributeTok{frequency =} \FunctionTok{frequency}\NormalTok{(list.ts[[}\DecValTok{1}\NormalTok{]]))}
\NormalTok{  ts.all.original }\OtherTok{\textless{}{-}} \FunctionTok{window}\NormalTok{(list.ts[[}\DecValTok{2}\NormalTok{]], }\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\FunctionTok{year}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(start\_train)), }\FunctionTok{month}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(start\_train))), }\AttributeTok{frequency =} \FunctionTok{frequency}\NormalTok{(list.ts[[}\DecValTok{1}\NormalTok{]]))}
  
\NormalTok{  number.of.steps.in.train }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(ts.all[}\FunctionTok{as.Date}\NormalTok{(}\FunctionTok{as.yearmon}\NormalTok{(}\FunctionTok{time}\NormalTok{(ts.all))) }\SpecialCharTok{\textless{}}\NormalTok{ start\_test]) }\CommentTok{\# The length of our training set.}
  
  \ControlFlowTok{if}\NormalTok{(number.of.steps.in.train }\SpecialCharTok{\textless{}} \DecValTok{12}\NormalTok{) \{ }\CommentTok{\# If the number of steps in the training set is less than twelve, but six or more, lengthen the training set by until it\textquotesingle{}s twelve months}
    \ControlFlowTok{if}\NormalTok{(number.of.steps.in.train }\SpecialCharTok{\textless{}} \DecValTok{6}\NormalTok{) \{}
      \FunctionTok{flog.warn}\NormalTok{(}\FunctionTok{cat}\NormalTok{(}\FunctionTok{red}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Skipping due to less than twelve months between start\_train and start\_test for"}\NormalTok{, id\_of\_ts))))}
      \FunctionTok{return}\NormalTok{(}\ConstantTok{NULL}\NormalTok{)}
\NormalTok{    \}}
\NormalTok{    start\_test }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(start\_test) }\SpecialCharTok{\%m+\%} \FunctionTok{months}\NormalTok{(}\DecValTok{12} \SpecialCharTok{{-}}\NormalTok{ number.of.steps.in.train)    }
\NormalTok{    number.of.steps.in.train }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(ts.all[}\FunctionTok{as.Date}\NormalTok{(}\FunctionTok{as.yearmon}\NormalTok{(}\FunctionTok{time}\NormalTok{(ts.all))) }\SpecialCharTok{\textless{}}\NormalTok{ start\_test])}
\NormalTok{  \}}
  
\NormalTok{  number.of.steps.in.test }\OtherTok{\textless{}{-}}\NormalTok{ (}\FunctionTok{length}\NormalTok{(ts.all) }\SpecialCharTok{{-}}\NormalTok{ number.of.steps.in.train) }\SpecialCharTok{+} \DecValTok{1} \CommentTok{\# The length of the test set is the training set\textquotesingle{}s complement of one. The + 1 comes from the last step, which is the "true" out{-}of{-}sample forecast step of the months that we don\textquotesingle{}t yet know the actual/true value for.}
\NormalTok{  total.number.of.steps }\OtherTok{\textless{}{-}}\NormalTok{ number.of.steps.in.test }\SpecialCharTok{+} \FunctionTok{max}\NormalTok{(months.ahead) }\CommentTok{\# The number of training steps and the "true" out{-}of{-}sample forecast steps together.}

  \CommentTok{\# step represents the shift in the ending position of the "training set window". For example, if max(as.Date(time(list.ts[[1]]))) = "2023{-}12{-}01", start\_train = "2013{-}03{-}01" and start\_test = "2020{-}09{-}01", we get:}
  \CommentTok{\# step \textless{}{-} 1 \# The "training set window" becomes:}
  \CommentTok{\#       Jan   Feb   Mar   Apr   May   Jun   Jul   Aug   Sep   Oct   Nov   Dec}
  \CommentTok{\# 2013              {-}1.0  {-}0.8   6.4   6.2   6.8   2.3   0.4  {-}5.4  {-}1.4   4.2}
  \CommentTok{\# 2014  {-}3.3  16.7  12.8  16.4   7.9   5.5   7.1   8.5   0.9   4.3   0.9   2.9}
  \CommentTok{\# 2015  13.8   7.6   3.1  {-}2.2  {-}5.9  {-}1.9   0.4   4.6   8.1  11.9   6.7   5.5}
  \CommentTok{\# 2016   2.4  {-}1.5   3.3  {-}0.4   6.7   2.6  {-}0.9   4.0  {-}4.1 {-}10.0  {-}1.0  {-}0.8}
  \CommentTok{\# 2017   6.4   6.2   6.8   2.3   0.4  {-}5.4  {-}1.4   4.2  {-}3.3  16.7  12.8  16.4}
  \CommentTok{\# 2018   7.9   5.5   7.1   8.5   0.9   4.3   0.9   2.9  13.8   7.6   3.1  {-}2.2}
  \CommentTok{\# 2019  {-}5.9  {-}1.9   0.4   4.6   8.1  11.9   6.7   5.5   2.4  {-}1.5   3.3  {-}0.4}
  \CommentTok{\# 2020   6.7   2.6  {-}0.9   4.0  {-}4.1 {-}10.0  {-}1.0  {-}0.8}

  \CommentTok{\# step \textless{}{-} 2 \# The "training set window" lengthens by one becoming:}
  \CommentTok{\#         Jan   Feb   Mar   Apr   May   Jun   Jul   Aug   Sep   Oct   Nov   Dec}
  \CommentTok{\# 2013              {-}1.0  {-}0.8   6.4   6.2   6.8   2.3   0.4  {-}5.4  {-}1.4   4.2}
  \CommentTok{\# 2014  {-}3.3  16.7  12.8  16.4   7.9   5.5   7.1   8.5   0.9   4.3   0.9   2.9}
  \CommentTok{\# 2015  13.8   7.6   3.1  {-}2.2  {-}5.9  {-}1.9   0.4   4.6   8.1  11.9   6.7   5.5}
  \CommentTok{\# 2016   2.4  {-}1.5   3.3  {-}0.4   6.7   2.6  {-}0.9   4.0  {-}4.1 {-}10.0  {-}1.0  {-}0.8}
  \CommentTok{\# 2017   6.4   6.2   6.8   2.3   0.4  {-}5.4  {-}1.4   4.2  {-}3.3  16.7  12.8  16.4}
  \CommentTok{\# 2018   7.9   5.5   7.1   8.5   0.9   4.3   0.9   2.9  13.8   7.6   3.1  {-}2.2}
  \CommentTok{\# 2019  {-}5.9  {-}1.9   0.4   4.6   8.1  11.9   6.7   5.5   2.4  {-}1.5   3.3  {-}0.4}
  \CommentTok{\# 2020   6.7   2.6  {-}0.9   4.0  {-}4.1 {-}10.0  {-}1.0  {-}0.8   6.4}

  \CommentTok{\# step \textless{}{-} 3 \# The "training set window" lengthens by one becoming:}
  \CommentTok{\#         Jan   Feb   Mar   Apr   May   Jun   Jul   Aug   Sep   Oct   Nov   Dec}
  \CommentTok{\# 2013              {-}1.0  {-}0.8   6.4   6.2   6.8   2.3   0.4  {-}5.4  {-}1.4   4.2}
  \CommentTok{\# 2014  {-}3.3  16.7  12.8  16.4   7.9   5.5   7.1   8.5   0.9   4.3   0.9   2.9}
  \CommentTok{\# 2015  13.8   7.6   3.1  {-}2.2  {-}5.9  {-}1.9   0.4   4.6   8.1  11.9   6.7   5.5}
  \CommentTok{\# 2016   2.4  {-}1.5   3.3  {-}0.4   6.7   2.6  {-}0.9   4.0  {-}4.1 {-}10.0  {-}1.0  {-}0.8}
  \CommentTok{\# 2017   6.4   6.2   6.8   2.3   0.4  {-}5.4  {-}1.4   4.2  {-}3.3  16.7  12.8  16.4}
  \CommentTok{\# 2018   7.9   5.5   7.1   8.5   0.9   4.3   0.9   2.9  13.8   7.6   3.1  {-}2.2}
  \CommentTok{\# 2019  {-}5.9  {-}1.9   0.4   4.6   8.1  11.9   6.7   5.5   2.4  {-}1.5   3.3  {-}0.4}
  \CommentTok{\# 2020   6.7   2.6  {-}0.9   4.0  {-}4.1 {-}10.0  {-}1.0  {-}0.8   6.4   6.2}

  \CommentTok{\# And so on, while the "test set window" is always the next four steps that come after the "training set window", such as for step = 1:}
  \CommentTok{\# [[2]]}
  \CommentTok{\# [[2]][[1]]}
  \CommentTok{\# [1] 6.4}

  \CommentTok{\# [[2]][[2]]}
  \CommentTok{\# [1] 6.2}

  \CommentTok{\# [[2]][[3]]}
  \CommentTok{\# [1] 6.8}

  \CommentTok{\# [[2]][[4]]}
  \CommentTok{\# [1] 2.3}

  \CommentTok{\# The "test set window" is what we can always evaluate our forecasts against made based on the "training set window" of each step, until our step reaches a point where the "test set window" goes over our last observation, "2023{-}12{-}01", in our training{-}test set after which we cannot evaluate anymore, because the forecasts are truly out{-}of{-}sample.}

  \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{exists}\NormalTok{(}\StringTok{"forecasts.per.month"}\NormalTok{)) \{}
    \FunctionTok{rm}\NormalTok{(forecasts.per.month)}
\NormalTok{  \}}
  \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{exists}\NormalTok{(}\StringTok{"temp.list"}\NormalTok{)) \{}
    \FunctionTok{rm}\NormalTok{(temp.list)}
\NormalTok{  \}}

  \CommentTok{\# Create the dataframe where to place the forecasts, first as a place holder consisting only of the observed values ("Base")}
\NormalTok{  forecasts.per.month }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Y=}\FunctionTok{as.matrix}\NormalTok{(ts.all.original), }\AttributeTok{date=}\FunctionTok{as.Date}\NormalTok{(}\FunctionTok{as.yearmon}\NormalTok{(}\FunctionTok{time}\NormalTok{(ts.all.original))), }\AttributeTok{model =} \StringTok{"Base"}\NormalTok{, }\AttributeTok{type =} \StringTok{"None"}\NormalTok{)}

  \CommentTok{\# step \textless{}{-} 1}
  \CommentTok{\# step \textless{}{-} 2}
  \CommentTok{\# step \textless{}{-} 3}
  \CommentTok{\# step \textless{}{-} 4}
  \CommentTok{\# step \textless{}{-} 5}
  \CommentTok{\# step \textless{}{-} 39}
  \ControlFlowTok{for}\NormalTok{(step }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{(number.of.steps.in.test))\{}
    \CommentTok{\# print.progress(progressCounter, dataFull, id\_of\_ts)}

    \FunctionTok{flog.info}\NormalTok{(}\FunctionTok{cat}\NormalTok{(}\FunctionTok{red}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Step"}\NormalTok{, step, }\StringTok{"out of"}\NormalTok{, number.of.steps.in.test))))}
\NormalTok{    train\_test\_set }\OtherTok{\textless{}{-}} \FunctionTok{create\_train\_test}\NormalTok{(start\_train, start\_test, ts.all.original, step, number.of.steps.in.test, months.ahead) }\CommentTok{\# Where [[1]] is the current step\textquotesingle{}s "training{-}test set window", and [[2]] holds the "test set window"}

    \CommentTok{\# Train the models with this "training set window":}
\NormalTok{    list\_mod }\OtherTok{\textless{}{-}} \FunctionTok{train\_ts\_models}\NormalTok{(}\AttributeTok{ts\_train =}\NormalTok{ train\_test\_set[[}\DecValTok{1}\NormalTok{]], id\_of\_ts, skipTimeConsumingAlgorithmsFlag)}

    \CommentTok{\# if(!exists("forecasts.per.month"))\{}
    \CommentTok{\# \}}

    \CommentTok{\# Forecast this step:}
    \CommentTok{\# names(forecasts.per.month)[1] \textless{}{-} "Y"}
\NormalTok{    forecasts.per.month }\OtherTok{\textless{}{-}} \FunctionTok{predict\_ts\_models}\NormalTok{(list\_mod, }\AttributeTok{ts\_val =}\NormalTok{ train\_test\_set[[}\DecValTok{2}\NormalTok{]], }\AttributeTok{forecasts\_per\_month =}\NormalTok{ forecasts.per.month, step, }\AttributeTok{total\_steps =}\NormalTok{ total.number.of.steps, months.ahead, id\_of\_ts, skipTimeConsumingAlgorithmsFlag)}
    \CommentTok{\# Sort forecasts.per.month by date ascending and then type}
\NormalTok{    forecasts.per.month }\OtherTok{\textless{}{-}}\NormalTok{ forecasts.per.month[}\FunctionTok{order}\NormalTok{(forecasts.per.month}\SpecialCharTok{$}\NormalTok{date, forecasts.per.month}\SpecialCharTok{$}\NormalTok{type), ]}
    \CommentTok{\# Round to one desimal}
\NormalTok{    forecasts.per.month}\SpecialCharTok{$}\NormalTok{Y }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(forecasts.per.month}\SpecialCharTok{$}\NormalTok{Y, }\DecValTok{1}\NormalTok{)}
\NormalTok{    upper\_limit }\OtherTok{=} \DecValTok{10}
    \CommentTok{\# Cap forecasts over upper\_limit}
\NormalTok{    forecasts.per.month}\SpecialCharTok{$}\NormalTok{Y[forecasts.per.month}\SpecialCharTok{$}\NormalTok{Y }\SpecialCharTok{\textgreater{}}\NormalTok{ upper\_limit] }\OtherTok{\textless{}{-}} \ConstantTok{NA}
\NormalTok{    forecasts.per.month}\SpecialCharTok{$}\NormalTok{Y[}\FunctionTok{is.na}\NormalTok{(forecasts.per.month}\SpecialCharTok{$}\NormalTok{Y)] }\OtherTok{\textless{}{-}} \FunctionTok{max}\NormalTok{(forecasts.per.month}\SpecialCharTok{$}\NormalTok{Y, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{    forecasts.per.month}\SpecialCharTok{$}\NormalTok{Y }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(forecasts.per.month}\SpecialCharTok{$}\NormalTok{Y, }\DecValTok{1}\NormalTok{)}
    \CommentTok{\# print(forecasts.per.month)}
\NormalTok{  \}}
 
  \CommentTok{\# For target variables that should not have negative values, handle them:}
  \CommentTok{\# forecasts.per.month$Y \textless{}{-} ifelse(forecasts.per.month$Y \textless{} 0, 0, forecasts.per.month$Y)}

\NormalTok{  temp.list }\OtherTok{\textless{}{-}} \FunctionTok{evaluate\_models}\NormalTok{(dataFull, }\AttributeTok{ts\_all =}\NormalTok{ ts.all, }\AttributeTok{ts\_all\_original =}\NormalTok{ ts.all.original, forecasts.per.month, id\_of\_ts, start\_test, months.ahead, first.month.to.forecast, progressCounter, mape.output.filename) }\CommentTok{\# nolint}
\NormalTok{  temp.list[[}\DecValTok{5}\NormalTok{]] }\OtherTok{\textless{}{-}}\NormalTok{ forecasts.per.month }\CommentTok{\# In temp.list [[1]] are the "best{-}performer out{-}of{-}sample forecasts" for each four, truly out{-}of{-}sample steps, [[2]] is the name of the "best{-}performer" for those forecasts, respectively, [[3]] is the "best{-}performer\textquotesingle{}s" predictive performance metrics for each step in the test set, and [[4]] is the dataframe with all the observations and all the forecasts, both in{-}the{-}sample and out{-}of{-}sample.}

  \FunctionTok{flog.info}\NormalTok{(}\FunctionTok{cat}\NormalTok{(}\FunctionTok{red}\NormalTok{(}\StringTok{"The contents of temp.list:}\SpecialCharTok{\textbackslash{}n}\StringTok{[[1]] are the \textquotesingle{}best{-}performer out{-}of{-}sample forecasts\textquotesingle{} for each four, truly out{-}of{-}sample steps,}\SpecialCharTok{\textbackslash{}n}\StringTok{[[2]] is the name of the \textquotesingle{}best{-}performer\textquotesingle{} for those forecasts, respectively,}\SpecialCharTok{\textbackslash{}n}\StringTok{[[3]] is the \textquotesingle{}best{-}performer\textquotesingle{}s\textquotesingle{} predictive performance metrics for each step in the test set, and}\SpecialCharTok{\textbackslash{}n}\StringTok{[[4]] is the dataframe with all the observations and all the forecasts, both in{-}the{-}sample and out{-}of{-}sample.}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)))}
  \FunctionTok{return}\NormalTok{(temp.list)}
\NormalTok{\}}

\NormalTok{prepare\_data\_for\_evaluation }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(ts\_all, forecasts.subset, start.test, months.to.forecast)\{}
\DocumentationTok{\#\#\# Creates a list out of the forecast values.}
\DocumentationTok{\#\#\# Parameters:}
\DocumentationTok{\#\#\# ts\_all: The time series.}
\DocumentationTok{\#\#\# forecasts: The forecasts.}
\DocumentationTok{\#\#\# start\_test: The start date of the test data.}
\DocumentationTok{\#\#\# Returns:}

\CommentTok{\# For testing:}
\CommentTok{\# rm(pred)}
\CommentTok{\# months.to.forecast \textless{}{-} "1\_ahead"}
\CommentTok{\# months.to.forecast \textless{}{-} "2\_ahead"}
\CommentTok{\# months.to.forecast \textless{}{-} "3\_ahead"}
\CommentTok{\# months.to.forecast \textless{}{-} "4\_ahead"}

  \FunctionTok{flog.info}\NormalTok{(}\StringTok{"Preparing data for evaluation"}\NormalTok{)}
  \ControlFlowTok{if}\NormalTok{(}\FunctionTok{frequency}\NormalTok{(ts\_all) }\SpecialCharTok{==} \DecValTok{12}\NormalTok{)\{}
\NormalTok{    forecasts.subset }\OtherTok{\textless{}{-}}\NormalTok{ forecasts.subset[forecasts.subset}\SpecialCharTok{$}\NormalTok{date }\SpecialCharTok{\textgreater{}=} \FunctionTok{as.Date}\NormalTok{(start.test) }\SpecialCharTok{\%m+\%} \FunctionTok{months}\NormalTok{(}\FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{substr}\NormalTok{(months.to.forecast, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{),]}
\NormalTok{  \}}\ControlFlowTok{else}\NormalTok{\{}
\NormalTok{    forecasts.subset }\OtherTok{\textless{}{-}}\NormalTok{ forecasts.subset[forecasts.subset}\SpecialCharTok{$}\NormalTok{date }\SpecialCharTok{\textgreater{}=} \FunctionTok{nrow}\NormalTok{(forecasts[forecasts}\SpecialCharTok{$}\NormalTok{model }\SpecialCharTok{\%in\%} \StringTok{"Base"}\NormalTok{,]) }\SpecialCharTok{{-}} \FunctionTok{nrow}\NormalTok{(forecasts[forecasts}\SpecialCharTok{$}\NormalTok{model }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"Reg.seasonal"}\NormalTok{, }\StringTok{"Reg"}\NormalTok{, }\StringTok{"reg"}\NormalTok{),])}\SpecialCharTok{+}\DecValTok{1}\NormalTok{,]}
\NormalTok{  \}}
\NormalTok{  forecasts\_test\_set }\OtherTok{\textless{}{-}}\NormalTok{ forecasts.subset[forecasts.subset}\SpecialCharTok{$}\NormalTok{date }\SpecialCharTok{\textless{}=} \FunctionTok{max}\NormalTok{(forecasts.subset}\SpecialCharTok{$}\NormalTok{date[forecasts.subset}\SpecialCharTok{$}\NormalTok{model }\SpecialCharTok{\%in\%} \StringTok{"Base"}\NormalTok{]),]}

  \ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \FunctionTok{as.character}\NormalTok{(}\FunctionTok{unique}\NormalTok{(forecasts\_test\_set}\SpecialCharTok{$}\NormalTok{model)))\{}
    \CommentTok{\# i \textless{}{-} "Base"}
    \CommentTok{\# i \textless{}{-} "Reg.seasonal"}
    \CommentTok{\# i \textless{}{-} "Reg.trend.seasonal"}
    \CommentTok{\# i \textless{}{-} "HW.Mul"}
    \CommentTok{\# i \textless{}{-} "HW.Add"}
    \CommentTok{\# i \textless{}{-} "Naive.prev.year"}
    \CommentTok{\# i \textless{}{-} "Naive.prev.datapoint"}
    \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{exists}\NormalTok{(}\StringTok{"pred"}\NormalTok{)) \{}
\NormalTok{      tmp }\OtherTok{\textless{}{-}}\NormalTok{ forecasts\_test\_set[forecasts\_test\_set}\SpecialCharTok{$}\NormalTok{model }\SpecialCharTok{==}\NormalTok{ i, }\FunctionTok{c}\NormalTok{(}\StringTok{"Y"}\NormalTok{, }\StringTok{"date"}\NormalTok{)]}
\NormalTok{      pred }\OtherTok{\textless{}{-}} \FunctionTok{merge}\NormalTok{(pred, tmp, }\AttributeTok{by =} \StringTok{"date"}\NormalTok{, }\AttributeTok{all.x =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{    \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{      pred }\OtherTok{\textless{}{-}}\NormalTok{ forecasts\_test\_set[forecasts\_test\_set}\SpecialCharTok{$}\NormalTok{model }\SpecialCharTok{==}\NormalTok{ i, }\FunctionTok{c}\NormalTok{(}\StringTok{"Y"}\NormalTok{, }\StringTok{"date"}\NormalTok{)]}
\NormalTok{      pred }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{date =}\NormalTok{ pred}\SpecialCharTok{$}\NormalTok{date, }\FunctionTok{ts}\NormalTok{(pred}\SpecialCharTok{$}\NormalTok{Y))}
\NormalTok{    \}}
    \FunctionTok{names}\NormalTok{(pred)[}\DecValTok{2}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(}\FunctionTok{names}\NormalTok{(pred))] }\OtherTok{\textless{}{-}} \FunctionTok{as.character}\NormalTok{(}\FunctionTok{unique}\NormalTok{(forecasts\_test\_set}\SpecialCharTok{$}\NormalTok{model))[}\DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(pred)}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}
\NormalTok{  \}}
  
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\FunctionTok{ncol}\NormalTok{(pred)) \{}
\NormalTok{    pred[, i] }\OtherTok{\textless{}{-}} \FunctionTok{ifelse}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(pred[, i]), }\DecValTok{0}\NormalTok{, pred[, i])}
\NormalTok{  \}}
  
  \CommentTok{\# for (i in 2:ncol(pred)) \{}
  \CommentTok{\#   if (any(is.na(pred[, i]))) \{}
  \CommentTok{\#     for (naValueIndex in which(is.na(pred[, i]))) \{}
  \CommentTok{\#       if (naValueIndex \textgreater{} 1) \{}
  \CommentTok{\#         if (naValueIndex \textless{} nrow(pred)) \{}
  \CommentTok{\#           pred[naValueIndex, i] \textless{}{-} (pred[naValueIndex {-} 1, i] + pred[naValueIndex + 1, i]) / 2}
  \CommentTok{\#         \} else \{}
  \CommentTok{\#           pred[naValueIndex, i] \textless{}{-} pred[naValueIndex {-} 1, i]}
  \CommentTok{\#         \}}
  \CommentTok{\#       \} else \{}
  \CommentTok{\#         pred[naValueIndex, i] \textless{}{-} pred[naValueIndex + 1, i]}
  \CommentTok{\#       \}}
  \CommentTok{\#       if (is.na(pred[naValueIndex, i])) \{}
  \CommentTok{\#         pred[naValueIndex, i] \textless{}{-} 0}
  \CommentTok{\#       \}}
  \CommentTok{\#     \}}
  \CommentTok{\#   \}}
  \CommentTok{\# \}}
  \FunctionTok{return}\NormalTok{(}\FunctionTok{list}\NormalTok{(pred, forecasts\_test\_set))}
\NormalTok{\}}

\NormalTok{error\_metrics }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(pred, id\_of\_ts, months.to.forecast, }\AttributeTok{mape.output.filename =} \ConstantTok{NULL}\NormalTok{)\{}
\DocumentationTok{\#\#\# Gets the error metrics.}
\DocumentationTok{\#\#\# Parameters:}
\DocumentationTok{\#\#\# mape.output.filename: The filename of a output text file with the MAPE outputs.}
\DocumentationTok{\#\#\# Returns:}
\DocumentationTok{\#\#\# The error metrics in a data frame.}
  
  \FunctionTok{flog.info}\NormalTok{(}\StringTok{"Getting the error metrics."}\NormalTok{)}
\NormalTok{  evaluation\_in\_whole\_test }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(}\FunctionTok{accuracy}\NormalTok{(}\FunctionTok{ts}\NormalTok{(pred[,}\DecValTok{3}\NormalTok{]), }\FunctionTok{ts}\NormalTok{(pred}\SpecialCharTok{$}\NormalTok{Base)))}
  \ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{4}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(pred))\{}
\NormalTok{    evaluation\_in\_whole\_test }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(evaluation\_in\_whole\_test, }\FunctionTok{accuracy}\NormalTok{(}\FunctionTok{ts}\NormalTok{(pred[,i]), }\FunctionTok{ts}\NormalTok{(pred}\SpecialCharTok{$}\NormalTok{Base))}
\NormalTok{    )}
\NormalTok{  \}}
  
  \FunctionTok{row.names}\NormalTok{(evaluation\_in\_whole\_test) }\OtherTok{\textless{}{-}} \FunctionTok{names}\NormalTok{(pred)[}\DecValTok{3}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(pred)]}
  
\NormalTok{  evaluation\_in\_whole\_test }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(evaluation\_in\_whole\_test)}
\NormalTok{  evaluation\_in\_whole\_test }\OtherTok{\textless{}{-}}\NormalTok{ evaluation\_in\_whole\_test[, (}\FunctionTok{names}\NormalTok{(evaluation\_in\_whole\_test) }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"RMSE"}\NormalTok{, }\StringTok{"MAE"}\NormalTok{, }\StringTok{"MAPE"}\NormalTok{))] }\CommentTok{\# Because MAPE gives Inf in many cases (due to division by zero)}
  
  \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{is.null}\NormalTok{(mape.output.filename)) \{}
    \FunctionTok{print}\NormalTok{(}\FunctionTok{paste}\NormalTok{(id\_of\_ts))}
    \FunctionTok{print}\NormalTok{(}\FunctionTok{round}\NormalTok{(evaluation\_in\_whole\_test[}\FunctionTok{order}\NormalTok{(evaluation\_in\_whole\_test}\SpecialCharTok{$}\NormalTok{MAPE),], }\DecValTok{5}\NormalTok{))}
    \FunctionTok{sink}\NormalTok{(}\AttributeTok{file =} \FunctionTok{paste}\NormalTok{(i, mape.output.filename, }\AttributeTok{sep =} \StringTok{"\_"}\NormalTok{), }\AttributeTok{append =} \ConstantTok{TRUE}\NormalTok{)}
    \FunctionTok{print}\NormalTok{(}\FunctionTok{paste}\NormalTok{(id\_of\_ts))}
    \FunctionTok{print}\NormalTok{(}\FunctionTok{round}\NormalTok{(evaluation\_in\_whole\_test[}\FunctionTok{order}\NormalTok{(evaluation\_in\_whole\_test}\SpecialCharTok{$}\NormalTok{MAPE),], }\DecValTok{5}\NormalTok{))}
    \FunctionTok{sink}\NormalTok{()}
\NormalTok{  \}}
  
  \FunctionTok{return}\NormalTok{(evaluation\_in\_whole\_test)}
\NormalTok{\}}


\NormalTok{plot\_base\_forecasts }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(forecasts, best.model.performance, months.ahead, id\_of\_ts, }\AttributeTok{plotModelQuadrantGraphFlag =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{plotBestPerformerErrorGraphsFlag =} \ConstantTok{FALSE}\NormalTok{) \{}
\DocumentationTok{\#\#\# Plots graphs for forecasts and realized values}
\DocumentationTok{\#\#\# Parameters:}
\DocumentationTok{\#\#\# forecasts:}
\DocumentationTok{\#\#\# best.model.performance:}
\DocumentationTok{\#\#\# months.ahead: The months ahead to be forecasted as a vector. 1 is the current (incomplete) month.}
\DocumentationTok{\#\#\# plotModelQuadrantGraphFlag:}
\DocumentationTok{\#\#\# plotBestPerformerErroGraphsFlag:}
\NormalTok{  no\_of\_naive\_models }\OtherTok{\textless{}{-}} \DecValTok{1}
  \CommentTok{\# Create graphs with the realized demand and the forecast of each of the models in the same picture.}
  \CommentTok{\# k \textless{}{-} 1}
  \FunctionTok{options}\NormalTok{(}\AttributeTok{repr.plot.width=}\DecValTok{30}\NormalTok{, }\AttributeTok{repr.plot.height=}\DecValTok{8}\NormalTok{)}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in}\NormalTok{ months.ahead) \{}
\NormalTok{    plots\_list }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}
    \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \FunctionTok{seq}\NormalTok{(no\_of\_naive\_models, }\FunctionTok{length}\NormalTok{(}\FunctionTok{unique}\NormalTok{(forecasts}\SpecialCharTok{$}\NormalTok{model)), }\DecValTok{1}\NormalTok{)) \{}
\NormalTok{      p }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(forecasts[forecasts}\SpecialCharTok{$}\NormalTok{model }\SpecialCharTok{\%in\%} \FunctionTok{as.character}\NormalTok{(}\FunctionTok{unique}\NormalTok{(forecasts}\SpecialCharTok{$}\NormalTok{model)[}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, j)]) }\SpecialCharTok{\&}\NormalTok{ (forecasts}\SpecialCharTok{$}\NormalTok{type }\SpecialCharTok{==} \FunctionTok{paste0}\NormalTok{(k, }\StringTok{"\_ahead"}\NormalTok{) }\SpecialCharTok{|}\NormalTok{ (forecasts}\SpecialCharTok{$}\NormalTok{date }\SpecialCharTok{\textgreater{}=} \FunctionTok{as.Date}\NormalTok{(}\FunctionTok{as.yearmon}\NormalTok{(}\FunctionTok{Sys.Date}\NormalTok{())) }\SpecialCharTok{\&} \FunctionTok{na\_replace}\NormalTok{(}\FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{substr}\NormalTok{(forecasts}\SpecialCharTok{$}\NormalTok{type, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{)), }\DecValTok{99}\NormalTok{) }\SpecialCharTok{\textless{}=}\NormalTok{ k) }\SpecialCharTok{|}\NormalTok{ forecasts}\SpecialCharTok{$}\NormalTok{type }\SpecialCharTok{==} \StringTok{"None"}\NormalTok{), ], }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ date, }\AttributeTok{y =}\NormalTok{ Y, }\AttributeTok{col =}\NormalTok{ model)) }\SpecialCharTok{+}
        \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
        \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size =} \FloatTok{0.8}\NormalTok{) }\SpecialCharTok{+}
        \FunctionTok{ylab}\NormalTok{(}\StringTok{""}\NormalTok{) }\SpecialCharTok{+}
        \FunctionTok{xlab}\NormalTok{(}\StringTok{""}\NormalTok{) }\SpecialCharTok{+}
        \FunctionTok{ggtitle}\NormalTok{(}\FunctionTok{paste}\NormalTok{(id\_of\_ts, }\AttributeTok{sep =} \StringTok{" {-} "}\NormalTok{), }\AttributeTok{subtitle =} \FunctionTok{paste}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Current + "}\NormalTok{, k }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{, }\StringTok{" mon ahead"}\NormalTok{), }\StringTok{"{-}"}\NormalTok{, }\StringTok{"Creation time:"}\NormalTok{, }\FunctionTok{Sys.time}\NormalTok{(), }\StringTok{"UTC"}\NormalTok{)) }\SpecialCharTok{+}
        \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.line =} \FunctionTok{element\_line}\NormalTok{(), }\AttributeTok{axis.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{color =} \StringTok{"black"}\NormalTok{), }\AttributeTok{axis.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{colour =} \StringTok{"black"}\NormalTok{), }\AttributeTok{legend.text =} \FunctionTok{element\_text}\NormalTok{(), }\AttributeTok{legend.title =} \FunctionTok{element\_text}\NormalTok{(), }\AttributeTok{legend.key =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{colour =} \StringTok{"black"}\NormalTok{), }\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{), }\AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{8}\NormalTok{))}
\NormalTok{      plots\_list }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(plots\_list, }\FunctionTok{list}\NormalTok{(p))}
\NormalTok{    \}}
    \CommentTok{\# print(plots\_list)}

    \CommentTok{\# plotModelQuadrantGraphFlag \textless{}{-} TRUE}
    \ControlFlowTok{if}\NormalTok{ (plotModelQuadrantGraphFlag) \{}
      \CommentTok{\# The first two models:}
      \CommentTok{\# svg(filename = paste(id\_of\_ts, k, "ahead", "page\_1.svg", sep = "\_"), width = 10.7, height = 6, pointsize = 3)}
      \FunctionTok{grid.arrange}\NormalTok{(plots\_list[[}\DecValTok{1}\NormalTok{]], plots\_list[[}\DecValTok{2}\NormalTok{]], }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{, }\AttributeTok{widths=}\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{3}\NormalTok{))}
      \CommentTok{\# dev.off()}

      \CommentTok{\# The next two models:}
      \CommentTok{\# svg(filename = paste(id\_of\_ts, k, "ahead", "page\_2.svg", sep = "\_"), width = 10.7, height = 6, pointsize = 3)}
      \FunctionTok{grid.arrange}\NormalTok{(plots\_list[[}\DecValTok{3}\NormalTok{]], plots\_list[[}\DecValTok{4}\NormalTok{]], }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{, }\AttributeTok{widths=}\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{3}\NormalTok{))}

      \CommentTok{\# The next two models:}
      \CommentTok{\# svg(filename = paste(id\_of\_ts, k, "ahead", "page\_3.svg", sep = "\_"), width = 10.7, height = 6, pointsize = 3)}
      \FunctionTok{grid.arrange}\NormalTok{(plots\_list[[}\DecValTok{5}\NormalTok{]], plots\_list[[}\DecValTok{6}\NormalTok{]], }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{, }\AttributeTok{widths=}\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{3}\NormalTok{))}\CommentTok{\#,plots\_list[[7]],plots\_list[[8]], ncol = 2)}
      \CommentTok{\# dev.off()}
      
      \CommentTok{\# The naive models:}
      \CommentTok{\# svg(filename = paste(id\_of\_ts, k, "ahead", "page\_3.svg", sep = "\_"), width = 10.7, height = 6, pointsize = 3)}
      \CommentTok{\# grid.arrange(plots\_list[[9]],plots\_list[[10]])}
      \CommentTok{\# dev.off()}
\NormalTok{    \}}
    
    \CommentTok{\# Create error/residual graphs:}
\NormalTok{    mape }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(best.model.performance, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{Date,}\AttributeTok{y=}\NormalTok{MAPE)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\FunctionTok{paste}\NormalTok{(id\_of\_ts, }\FunctionTok{paste0}\NormalTok{(}\StringTok{"best model: "}\NormalTok{, }\FunctionTok{as.character}\NormalTok{(best.model.performance}\SpecialCharTok{$}\NormalTok{name[}\DecValTok{1}\NormalTok{])), }\AttributeTok{sep =} \StringTok{" {-} "}\NormalTok{)) }\SpecialCharTok{+} \FunctionTok{geom\_hline}\NormalTok{(}\AttributeTok{yintercept=}\DecValTok{0}\NormalTok{, }\AttributeTok{linetype =} \StringTok{"longdash"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{geom\_hline}\NormalTok{(}\AttributeTok{yintercept=}\FloatTok{0.2}\NormalTok{, }\AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{geom\_hline}\NormalTok{(}\AttributeTok{yintercept=}\SpecialCharTok{{-}}\FloatTok{0.2}\NormalTok{, }\AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{xlab}\NormalTok{(}\StringTok{""}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ylab}\NormalTok{(}\StringTok{"forecast \% difference to true value"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ylim}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.line =} \FunctionTok{element\_line}\NormalTok{(), }\AttributeTok{axis.text=}\FunctionTok{element\_text}\NormalTok{(}\AttributeTok{color=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{), }\AttributeTok{axis.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{colour =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{), }\AttributeTok{legend.text=}\FunctionTok{element\_text}\NormalTok{(), }\AttributeTok{legend.title=}\FunctionTok{element\_text}\NormalTok{(), }\AttributeTok{legend.key =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{colour =} \StringTok{"black"}\NormalTok{))}
    
\NormalTok{    mae }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(best.model.performance, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{Date,}\AttributeTok{y=}\NormalTok{MAE)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{geom\_hline}\NormalTok{(}\AttributeTok{yintercept=}\DecValTok{0}\NormalTok{, }\AttributeTok{linetype =} \StringTok{"longdash"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{xlab}\NormalTok{(}\StringTok{""}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ylab}\NormalTok{(}\StringTok{"forecast difference to true value"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.line =} \FunctionTok{element\_line}\NormalTok{(), }\AttributeTok{axis.text=}\FunctionTok{element\_text}\NormalTok{(}\AttributeTok{color=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{), }\AttributeTok{axis.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{colour =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{), }\AttributeTok{legend.text=}\FunctionTok{element\_text}\NormalTok{(), }\AttributeTok{legend.title=}\FunctionTok{element\_text}\NormalTok{(), }\AttributeTok{legend.key =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{colour =} \StringTok{"black"}\NormalTok{))}
    
    \CommentTok{\# plotBestPerformerErrorGraphsFlag \textless{}{-} TRUE}
    \ControlFlowTok{if}\NormalTok{ (plotBestPerformerErrorGraphsFlag) \{}
      \FunctionTok{svg}\NormalTok{(}\AttributeTok{filename =} \FunctionTok{paste}\NormalTok{(id\_of\_ts, k, }\StringTok{"ahead"}\NormalTok{, }\StringTok{"best.svg"}\NormalTok{, }\AttributeTok{sep =} \StringTok{"\_"}\NormalTok{), }\AttributeTok{width =} \FloatTok{10.7}\NormalTok{, }\AttributeTok{height =} \DecValTok{6}\NormalTok{, }\AttributeTok{pointsize =} \DecValTok{3}\NormalTok{)}
      \FunctionTok{grid.arrange}\NormalTok{(mape, mae, }\AttributeTok{ncol =} \DecValTok{1}\NormalTok{)}
      \FunctionTok{dev.off}\NormalTok{()}
\NormalTok{    \}}
\NormalTok{  \}}
  \FunctionTok{return}\NormalTok{(}\FunctionTok{list}\NormalTok{(mape, mae))}
\NormalTok{\}}

\NormalTok{plot.summary.graph }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(id\_of\_ts, demandsAndForecastWithYearCols, graph.filename, first.month.to.forecast) \{}
\NormalTok{  highestYear }\OtherTok{\textless{}{-}} \FunctionTok{year}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(first.month.to.forecast) }\SpecialCharTok{\%m{-}\%} \FunctionTok{months}\NormalTok{(}\DecValTok{1}\NormalTok{))}
  \FunctionTok{svg}\NormalTok{(}\AttributeTok{filename =}\NormalTok{ graph.filename, }\AttributeTok{wid\_of\_tsth =} \FloatTok{10.7}\NormalTok{, }\AttributeTok{height =} \DecValTok{6}\NormalTok{, }\AttributeTok{pointsize =} \DecValTok{3}\NormalTok{)}
\NormalTok{  p }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(demandsAndForecastWithYearCols) }\SpecialCharTok{+}
    \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{size =} \DecValTok{2}\NormalTok{, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{factor}\NormalTok{(}\FunctionTok{row.names}\NormalTok{(demandsAndForecastWithYearCols), }\AttributeTok{levels =} \FunctionTok{row.names}\NormalTok{(demandsAndForecastWithYearCols)), }\AttributeTok{y =}\NormalTok{ threeYrAvg, }\AttributeTok{col =} \StringTok{"3 year average"}\NormalTok{), }\AttributeTok{group =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{size =} \DecValTok{1}\NormalTok{, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{factor}\NormalTok{(}\FunctionTok{row.names}\NormalTok{(demandsAndForecastWithYearCols), }\AttributeTok{levels =} \FunctionTok{row.names}\NormalTok{(demandsAndForecastWithYearCols)), }\AttributeTok{y =}\NormalTok{ fiveYrAvg, }\AttributeTok{col =} \StringTok{"5 year average"}\NormalTok{), }\AttributeTok{group =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{factor}\NormalTok{(}\FunctionTok{row.names}\NormalTok{(demandsAndForecastWithYearCols), }\AttributeTok{levels =} \FunctionTok{row.names}\NormalTok{(demandsAndForecastWithYearCols)), }\AttributeTok{y =}\NormalTok{ prevYear, }\AttributeTok{col =} \StringTok{"Previous year"}\NormalTok{), }\AttributeTok{group =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{factor}\NormalTok{(}\FunctionTok{row.names}\NormalTok{(demandsAndForecastWithYearCols), }\AttributeTok{levels =} \FunctionTok{row.names}\NormalTok{(demandsAndForecastWithYearCols)), }\AttributeTok{y =}\NormalTok{ pred, }\AttributeTok{col =} \StringTok{"Forecasts"}\NormalTok{), }\AttributeTok{group =} \DecValTok{1}\NormalTok{, }\AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{shape =} \DecValTok{15}\NormalTok{, }\AttributeTok{size =} \DecValTok{2}\NormalTok{, }\AttributeTok{color =} \StringTok{"red"}\NormalTok{, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{factor}\NormalTok{(}\FunctionTok{row.names}\NormalTok{(demandsAndForecastWithYearCols), }\AttributeTok{levels =} \FunctionTok{row.names}\NormalTok{(demandsAndForecastWithYearCols)), }\AttributeTok{y =}\NormalTok{ pred, }\AttributeTok{col =} \StringTok{"Forecasts"}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{factor}\NormalTok{(}\FunctionTok{row.names}\NormalTok{(demandsAndForecastWithYearCols), }\AttributeTok{levels =} \FunctionTok{row.names}\NormalTok{(demandsAndForecastWithYearCols)), }\AttributeTok{y =}\NormalTok{ currentYear, }\AttributeTok{col =} \FunctionTok{as.character}\NormalTok{(highestYear), }\AttributeTok{group =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{shape =} \DecValTok{16}\NormalTok{, }\AttributeTok{size =} \DecValTok{3}\NormalTok{, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{factor}\NormalTok{(}\FunctionTok{row.names}\NormalTok{(demandsAndForecastWithYearCols), }\AttributeTok{levels =} \FunctionTok{row.names}\NormalTok{(demandsAndForecastWithYearCols)), }\AttributeTok{y =}\NormalTok{ currentYear, }\AttributeTok{col =} \FunctionTok{as.character}\NormalTok{(highestYear))) }\SpecialCharTok{+}
    \FunctionTok{scale\_color\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"black"}\NormalTok{, }\StringTok{"green4"}\NormalTok{, }\StringTok{"orange"}\NormalTok{, }\StringTok{"red"}\NormalTok{, }\StringTok{"blue"}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{ylab}\NormalTok{(}\StringTok{""}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{xlab}\NormalTok{(}\StringTok{""}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{ggtitle}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\FunctionTok{toupper}\NormalTok{(id\_of\_ts), }\StringTok{" forecasts:"}\NormalTok{, }\AttributeTok{sep =} \StringTok{" {-} "}\NormalTok{), }\AttributeTok{subtitle =} \FunctionTok{paste0}\NormalTok{(}\StringTok{"Current ("}\NormalTok{, }\FunctionTok{as.yearmon}\NormalTok{(first.month.to.forecast), }\StringTok{") + 3 months ahead. Creation time: "}\NormalTok{,  }\FunctionTok{Sys.time}\NormalTok{(), }\StringTok{" UTC"}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.line =} \FunctionTok{element\_line}\NormalTok{(),}
          \AttributeTok{axis.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{color=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{),}
          \AttributeTok{axis.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{colour =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{),}
          \AttributeTok{legend.text =} \FunctionTok{element\_text}\NormalTok{(),}
          \AttributeTok{legend.title =} \FunctionTok{element\_blank}\NormalTok{(),}
          \AttributeTok{legend.key =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{colour =} \StringTok{"black"}\NormalTok{),}
          \AttributeTok{legend.position =} \StringTok{"right"}\NormalTok{,}
          \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
          \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{))}
  \FunctionTok{print}\NormalTok{(p)}
  \FunctionTok{dev.off}\NormalTok{()}
\NormalTok{\}}

\NormalTok{best\_model }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(pred, forecasts.test.set, evaluation\_in\_whole\_test, months.to.forecast)\{}
\DocumentationTok{\#\#\# Gets the best performing models based on MAPE (primary) or MAE (secondary).}
\DocumentationTok{\#\#\# Parameters:}
\DocumentationTok{\#\#\# pred: A data frame with forecasts.}
\DocumentationTok{\#\#\#}
  \FunctionTok{flog.info}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Determining the best models for"}\NormalTok{, months.to.forecast))}

  \CommentTok{\# Filter out row index "Base" from evaluation\_in\_whole\_test}
\NormalTok{  evaluation\_in\_whole\_test }\OtherTok{\textless{}{-}}\NormalTok{ evaluation\_in\_whole\_test[}\SpecialCharTok{!}\NormalTok{(}\FunctionTok{rownames}\NormalTok{(evaluation\_in\_whole\_test) }\SpecialCharTok{==} \StringTok{"Base"}\NormalTok{), ]}

  \CommentTok{\# Compute the MAPEs and MAEs}

  \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{exists}\NormalTok{(}\StringTok{"evaluation"}\NormalTok{)) \{}
    \FunctionTok{rm}\NormalTok{(evaluation)}
\NormalTok{  \}}
  \CommentTok{\# First Reg.trend.seasonal...}
\NormalTok{  evaluation }\OtherTok{\textless{}{-}} \FunctionTok{cbind}\NormalTok{((}\FunctionTok{ts}\NormalTok{(pred[,}\SpecialCharTok{!}\NormalTok{(}\FunctionTok{names}\NormalTok{(pred) }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"date"}\NormalTok{, }\StringTok{"Base"}\NormalTok{))][}\DecValTok{1}\NormalTok{])}\SpecialCharTok{{-}}\FunctionTok{ts}\NormalTok{(pred}\SpecialCharTok{$}\NormalTok{Base))}\SpecialCharTok{/}\FunctionTok{ts}\NormalTok{(pred}\SpecialCharTok{$}\NormalTok{Base),(}\FunctionTok{ts}\NormalTok{(pred[,}\SpecialCharTok{!}\NormalTok{(}\FunctionTok{names}\NormalTok{(pred) }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"date"}\NormalTok{, }\StringTok{"Base"}\NormalTok{))][}\DecValTok{1}\NormalTok{])}\SpecialCharTok{{-}}\FunctionTok{ts}\NormalTok{(pred}\SpecialCharTok{$}\NormalTok{Base)))}
  \CommentTok{\# ...then the rest}
  \ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{4}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(pred))\{}
\NormalTok{    evaluation }\OtherTok{\textless{}{-}} \FunctionTok{cbind}\NormalTok{(evaluation, (}\FunctionTok{ts}\NormalTok{(pred[,i]) }\SpecialCharTok{{-}} \FunctionTok{ts}\NormalTok{(pred}\SpecialCharTok{$}\NormalTok{Base))}\SpecialCharTok{/}\FunctionTok{ts}\NormalTok{(pred}\SpecialCharTok{$}\NormalTok{Base))}
\NormalTok{    evaluation }\OtherTok{\textless{}{-}} \FunctionTok{cbind}\NormalTok{(evaluation, (}\FunctionTok{ts}\NormalTok{(pred[,i]) }\SpecialCharTok{{-}} \FunctionTok{ts}\NormalTok{(pred}\SpecialCharTok{$}\NormalTok{Base)))}
\NormalTok{  \}}
\NormalTok{  evaluation }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(evaluation)}
  \FunctionTok{names}\NormalTok{(evaluation) }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\FunctionTok{names}\NormalTok{(pred)[}\DecValTok{3}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(pred)], }\AttributeTok{times =} \DecValTok{1}\NormalTok{, }\AttributeTok{each =} \DecValTok{2}\NormalTok{)}
  
  \ControlFlowTok{if}\NormalTok{(}\FunctionTok{any}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.infinite}\NormalTok{(evaluation\_in\_whole\_test}\SpecialCharTok{$}\NormalTok{MAPE))) \{ }\CommentTok{\# If at least one of the MAPEs is not infinite, use the MAPE, otherwise use MAE}
\NormalTok{    best\_model\_performance }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{name =} \FunctionTok{row.names}\NormalTok{(evaluation\_in\_whole\_test[}\FunctionTok{order}\NormalTok{(evaluation\_in\_whole\_test}\SpecialCharTok{$}\NormalTok{MAPE),][}\DecValTok{1}\NormalTok{,]), }\AttributeTok{value =}\NormalTok{ evaluation[,}\FunctionTok{names}\NormalTok{(evaluation) }\SpecialCharTok{\%in\%} \FunctionTok{row.names}\NormalTok{(evaluation\_in\_whole\_test[}\FunctionTok{order}\NormalTok{(evaluation\_in\_whole\_test}\SpecialCharTok{$}\NormalTok{MAPE),][}\DecValTok{1}\NormalTok{,])], }\AttributeTok{Date =}\NormalTok{ forecasts.test.set}\SpecialCharTok{$}\NormalTok{date[}\FunctionTok{as.character}\NormalTok{(forecasts.test.set}\SpecialCharTok{$}\NormalTok{model) }\SpecialCharTok{\%in\%} \FunctionTok{row.names}\NormalTok{(evaluation\_in\_whole\_test[}\FunctionTok{order}\NormalTok{(evaluation\_in\_whole\_test}\SpecialCharTok{$}\NormalTok{MAPE),][}\DecValTok{1}\NormalTok{,])])}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{    best\_model\_performance }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{name =} \FunctionTok{row.names}\NormalTok{(evaluation\_in\_whole\_test[}\FunctionTok{order}\NormalTok{(evaluation\_in\_whole\_test}\SpecialCharTok{$}\NormalTok{MAE),][}\DecValTok{1}\NormalTok{,]),}\AttributeTok{value =}\NormalTok{ evaluation[,}\FunctionTok{names}\NormalTok{(evaluation) }\SpecialCharTok{\%in\%} \FunctionTok{row.names}\NormalTok{(evaluation\_in\_whole\_test[}\FunctionTok{order}\NormalTok{(evaluation\_in\_whole\_test}\SpecialCharTok{$}\NormalTok{MAE),][}\DecValTok{1}\NormalTok{,])], }\AttributeTok{Date =}\NormalTok{ forecasts.test.set}\SpecialCharTok{$}\NormalTok{date[}\FunctionTok{as.character}\NormalTok{(forecasts.test.set}\SpecialCharTok{$}\NormalTok{model) }\SpecialCharTok{\%in\%} \FunctionTok{row.names}\NormalTok{(evaluation\_in\_whole\_test[}\FunctionTok{order}\NormalTok{(evaluation\_in\_whole\_test}\SpecialCharTok{$}\NormalTok{MAE),][}\DecValTok{1}\NormalTok{,])])}
\NormalTok{  \}}
  \FunctionTok{names}\NormalTok{(best\_model\_performance)[}\DecValTok{2}\SpecialCharTok{:}\DecValTok{3}\NormalTok{] }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"MAPE"}\NormalTok{, }\StringTok{"MAE"}\NormalTok{)}

  \FunctionTok{return}\NormalTok{(best\_model\_performance)}
\NormalTok{\}}


\NormalTok{evaluate\_models }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(dataFull, ts\_all, ts\_all\_original, forecasts.per.month, id\_of\_ts, start\_test, months.ahead, first.month.to.forecast, progressCounter, mape.output.filename, ...) \{}
  \DocumentationTok{\#\#\# Evaluates the performance of the models, determines the best performing model and calls functions for plotting }
  \DocumentationTok{\#\#\# and creating an Excel file for the best performing model\textquotesingle{}s data.}
  \DocumentationTok{\#\#\# Parameters:}
  \DocumentationTok{\#\#\# ts\_all: The time series object.}
  \DocumentationTok{\#\#\# forecasts.per.month: The baseline (realized monthly demand) and all models\textquotesingle{} for all forecasts.}
  \DocumentationTok{\#\#\# start\_test: The start date for the testing dataset.}
  \DocumentationTok{\#\#\# months.ahead: The months ahead to be forecasted as a vector. 1 is the current (incomplete) month.}
  \DocumentationTok{\#\#\# mape.output.filename: The filename of a output text file with the MAPE outputs.}
  
\NormalTok{  highestYearinBase }\OtherTok{\textless{}{-}}  \FunctionTok{max}\NormalTok{(}\FunctionTok{year}\NormalTok{(}\FunctionTok{subset}\NormalTok{(forecasts.per.month, model }\SpecialCharTok{==} \StringTok{"Base"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{date))}
\NormalTok{  highestYearinForecasts }\OtherTok{\textless{}{-}}  \FunctionTok{max}\NormalTok{(}\FunctionTok{year}\NormalTok{(forecasts.per.month}\SpecialCharTok{$}\NormalTok{date))}
  \FunctionTok{flog.info}\NormalTok{(}\StringTok{"Evaluating models"}\NormalTok{)}
  \CommentTok{\# forecasts[forecasts["model"] == "Base", "Y"] \textless{}{-} c(ts.all.original) \# We do the evaluation against the original (non{-}imputed) realized values.}
\NormalTok{  best.model.names.per.step }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{()}

  \CommentTok{\# Sort forecasts.per.month by date ascending and then type}
\NormalTok{  forecasts.per.month }\OtherTok{\textless{}{-}}\NormalTok{ forecasts.per.month[}\FunctionTok{order}\NormalTok{(forecasts.per.month}\SpecialCharTok{$}\NormalTok{date, forecasts.per.month}\SpecialCharTok{$}\NormalTok{type), ]}
  \CommentTok{\# print(forecasts.per.month)}

  \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{exists}\NormalTok{(}\StringTok{"pred"}\NormalTok{)) \{}
    \FunctionTok{rm}\NormalTok{(pred)}
\NormalTok{  \}}
\NormalTok{  best.model.names.per.step }\OtherTok{\textless{}{-}} \ConstantTok{NULL}
  \ControlFlowTok{for}\NormalTok{(months.to.forecast }\ControlFlowTok{in} \FunctionTok{as.character}\NormalTok{(}\FunctionTok{unique}\NormalTok{(forecasts.per.month}\SpecialCharTok{$}\NormalTok{type)[}\SpecialCharTok{!}\NormalTok{(}\FunctionTok{unique}\NormalTok{(forecasts.per.month}\SpecialCharTok{$}\NormalTok{type) }\SpecialCharTok{\%in\%} \StringTok{"None"}\NormalTok{)]))\{}
    \CommentTok{\# months.to.forecast \textless{}{-} "1\_ahead"}
    \CommentTok{\# months.to.forecast \textless{}{-} "2\_ahead"}
    \CommentTok{\# months.to.forecast \textless{}{-} "3\_ahead"}
    \CommentTok{\# months.to.forecast \textless{}{-} "4\_ahead"}
    \FunctionTok{flog.info}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Evaluating"}\NormalTok{, months.to.forecast))}
\NormalTok{    forecasts.subset }\OtherTok{\textless{}{-}}\NormalTok{ forecasts.per.month[(forecasts.per.month}\SpecialCharTok{$}\NormalTok{type }\SpecialCharTok{==}\NormalTok{ months.to.forecast }\SpecialCharTok{|}\NormalTok{ forecasts.per.month}\SpecialCharTok{$}\NormalTok{type }\SpecialCharTok{==} \StringTok{"None"}\NormalTok{),]}
\NormalTok{    forecasts.test.set }\OtherTok{\textless{}{-}} \FunctionTok{prepare\_data\_for\_evaluation}\NormalTok{(}\AttributeTok{ts\_all =}\NormalTok{ ts\_all\_original, forecasts.subset, }\AttributeTok{start.test =}\NormalTok{ start\_test, months.to.forecast)}
\NormalTok{    evaluation.in.whole.test }\OtherTok{\textless{}{-}} \FunctionTok{error\_metrics}\NormalTok{(}\AttributeTok{pred =}\NormalTok{ forecasts.test.set[[}\DecValTok{1}\NormalTok{]], id\_of\_ts, months.to.forecast, mape.output.filename)}
\NormalTok{    evaluation.in.whole.test }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(evaluation.in.whole.test)}
\NormalTok{    best.model.performance }\OtherTok{\textless{}{-}} \FunctionTok{best\_model}\NormalTok{(}\AttributeTok{pred =}\NormalTok{ forecasts.test.set[[}\DecValTok{1}\NormalTok{]], }\AttributeTok{forecasts.test.set =}\NormalTok{ forecasts.test.set[[}\DecValTok{2}\NormalTok{]], }\AttributeTok{evaluation\_in\_whole\_test =}\NormalTok{ evaluation.in.whole.test, months.to.forecast)}
\NormalTok{    best.model.names.per.step }\OtherTok{\textless{}{-}} \FunctionTok{append}\NormalTok{(best.model.names.per.step, }\FunctionTok{as.character}\NormalTok{(best.model.performance}\SpecialCharTok{$}\NormalTok{name[}\DecValTok{1}\NormalTok{]), }\FunctionTok{length}\NormalTok{(best.model.names.per.step))}
\NormalTok{  \}}
  
\NormalTok{  forecastValues }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\StringTok{"fourth.month"} \OtherTok{=} \FunctionTok{subset}\NormalTok{(forecasts.per.month, model }\SpecialCharTok{==} \FunctionTok{as.character}\NormalTok{(best.model.names.per.step[}\DecValTok{4}\NormalTok{]) }\SpecialCharTok{\&}\NormalTok{ type }\SpecialCharTok{==} \StringTok{"4\_ahead"} \SpecialCharTok{\&}\NormalTok{ date }\SpecialCharTok{==} \FunctionTok{max}\NormalTok{(forecasts.per.month}\SpecialCharTok{$}\NormalTok{date))}\SpecialCharTok{$}\NormalTok{Y, }\StringTok{"third.month"} \OtherTok{=} \FunctionTok{subset}\NormalTok{(forecasts.per.month, model }\SpecialCharTok{==} \FunctionTok{as.character}\NormalTok{(best.model.names.per.step[}\DecValTok{3}\NormalTok{]) }\SpecialCharTok{\&}\NormalTok{ type }\SpecialCharTok{==} \StringTok{"3\_ahead"} \SpecialCharTok{\&} \FunctionTok{as.yearmon}\NormalTok{(date) }\SpecialCharTok{==} \FunctionTok{as.yearmon}\NormalTok{(}\FunctionTok{max}\NormalTok{(forecasts.per.month}\SpecialCharTok{$}\NormalTok{date) }\SpecialCharTok{\%m{-}\%} \FunctionTok{months}\NormalTok{(}\DecValTok{1}\NormalTok{)))}\SpecialCharTok{$}\NormalTok{Y, }\StringTok{"second.month"} \OtherTok{=} \FunctionTok{subset}\NormalTok{(forecasts.per.month, model }\SpecialCharTok{==} \FunctionTok{as.character}\NormalTok{(best.model.names.per.step[}\DecValTok{2}\NormalTok{]) }\SpecialCharTok{\&}\NormalTok{ type }\SpecialCharTok{==} \StringTok{"2\_ahead"} \SpecialCharTok{\&} \FunctionTok{as.yearmon}\NormalTok{(date) }\SpecialCharTok{==} \FunctionTok{as.yearmon}\NormalTok{(}\FunctionTok{max}\NormalTok{(forecasts.per.month}\SpecialCharTok{$}\NormalTok{date) }\SpecialCharTok{\%m{-}\%} \FunctionTok{months}\NormalTok{(}\DecValTok{2}\NormalTok{)))}\SpecialCharTok{$}\NormalTok{Y, }\StringTok{"current.month"} \OtherTok{=} \FunctionTok{subset}\NormalTok{(forecasts.per.month, model }\SpecialCharTok{==} \FunctionTok{as.character}\NormalTok{(best.model.names.per.step[}\DecValTok{1}\NormalTok{]) }\SpecialCharTok{\&}\NormalTok{ type }\SpecialCharTok{==} \StringTok{"1\_ahead"} \SpecialCharTok{\&} \FunctionTok{as.yearmon}\NormalTok{(date) }\SpecialCharTok{==} \FunctionTok{as.yearmon}\NormalTok{(}\FunctionTok{max}\NormalTok{(forecasts.per.month}\SpecialCharTok{$}\NormalTok{date) }\SpecialCharTok{\%m{-}\%} \FunctionTok{months}\NormalTok{(}\DecValTok{3}\NormalTok{)))}\SpecialCharTok{$}\NormalTok{Y)}
  
  \CommentTok{\# Save the forecasts in a global variable so that summary graph plotting can access them.}
  \FunctionTok{assign}\NormalTok{(}\FunctionTok{paste}\NormalTok{(id\_of\_ts, }\StringTok{"4{-}month forecast"}\NormalTok{, }\AttributeTok{sep =} \StringTok{"\_"}\NormalTok{), forecastValues, }\AttributeTok{envir =} \FunctionTok{globalenv}\NormalTok{())}
  
  \FunctionTok{return}\NormalTok{(}\FunctionTok{list}\NormalTok{(forecastValues, best.model.names.per.step, best.model.performance, evaluation.in.whole.test))}
\NormalTok{\}}

\NormalTok{print.progress }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(progressCounter, dataFull, id\_of\_ts) \{}
    \FunctionTok{flog.info}\NormalTok{(}\FunctionTok{cat}\NormalTok{(}\FunctionTok{red}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Overall progress: "}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\DecValTok{100} \SpecialCharTok{*}\NormalTok{ progressCounter }\SpecialCharTok{/}\NormalTok{ (}\FunctionTok{length}\NormalTok{(}\FunctionTok{unique}\NormalTok{(dataFull}\SpecialCharTok{$}\NormalTok{id\_of\_ts)) }\SpecialCharTok{*} \FunctionTok{length}\NormalTok{(}\FunctionTok{unique}\NormalTok{(dataFull}\SpecialCharTok{$}\NormalTok{Value))), }\DecValTok{1}\NormalTok{)), }\StringTok{"\%}\SpecialCharTok{\textbackslash{}n\textbackslash{}n}\StringTok{"}\NormalTok{)))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{start\_modeling\_process }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{()\{}
\DocumentationTok{\#\#\# The main function, which first sets up the environment, then fetches the data, iterates them through preparing}
\DocumentationTok{\#\#\# the time series for them, calls another function (split\_data\_and\_model\_monthly) for doing the model training and evaluation, uploads the summary graph onto.}

\NormalTok{  script.name }\OtherTok{\textless{}{-}} \StringTok{"timeseries\_forecast.R"} \CommentTok{\# This script\textquotesingle{}s name, which is needed when writing to BigQuery table.}
\NormalTok{  id\_of\_tss }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\StringTok{"USGDPGR"}\NormalTok{)}
  
\NormalTok{  aggregateLevelForecastsFlag }\OtherTok{\textless{}{-}} \ConstantTok{FALSE} \CommentTok{\# Set TRUE if wanted to compute the forecasts on the data aggregated on the id\_of\_ts level.}
\NormalTok{  plotModelQuadrantGraphFlag }\OtherTok{\textless{}{-}} \ConstantTok{TRUE} \CommentTok{\# Set TRUE if wanted to plot the "quadrant" of graphs, which show the performance of each algorithm against the realized demands data (the base).}
\NormalTok{  plotBestPerformerErrorGraphsFlag }\OtherTok{\textless{}{-}} \ConstantTok{FALSE} \CommentTok{\# Set TRUE if wanted to plot the MAPE and MAE of the algorithms that was evaluated to have performed the best.}
  
\NormalTok{  runInDevEnvironmentFlag }\OtherTok{\textless{}{-}} \ConstantTok{TRUE} \CommentTok{\# Set TRUE if wanted to run the script in development environment instead of production.}
\NormalTok{  disablePreviousMonthDataCheckFlag }\OtherTok{\textless{}{-}} \ConstantTok{FALSE} \CommentTok{\# Set TRUE if wanted to disable checking the the existance of data for the previous month.}
  
\NormalTok{  skipFetchingDataFlag }\OtherTok{\textless{}{-}} \ConstantTok{FALSE} \CommentTok{\# Set TRUE if wanted to run the script without fetching the data from BigQuery (instead use the data already in memory in global environment).}
\NormalTok{  skipTimeConsumingAlgorithmsFlag }\OtherTok{\textless{}{-}} \ConstantTok{TRUE} \CommentTok{\# Set TRUE if wanted to skip the forecasts using the most time consuming 4 models (ARIMA, ARIMA + boxcox, ETS, TBATS).}
\NormalTok{  skipComputingForecastsFlag }\OtherTok{\textless{}{-}} \ConstantTok{FALSE} \CommentTok{\# Set TRUE if wanted to run the script without computing the forecasts (instead use the forecasts already in memory in global environment).}
    
\NormalTok{  mape.output.filename }\OtherTok{\textless{}{-}} \ConstantTok{NULL} \CommentTok{\# Give a file name if wanted to save the MAPE results in a file.}
\NormalTok{  imputations.output.filename }\OtherTok{\textless{}{-}} \ConstantTok{NULL} \CommentTok{\# Give a file name if wanted to save the records about imputations in a file.}
  
\NormalTok{  months.ahead }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{) }\CommentTok{\# By default we forecast 4 months ahead.}
  
  \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{require}\NormalTok{(}\StringTok{"pacman"}\NormalTok{)) }\FunctionTok{install.packages}\NormalTok{(}\StringTok{"pacman"}\NormalTok{) }\CommentTok{\# get pcaman if not present and load it}
\NormalTok{  pacman}\SpecialCharTok{::}\FunctionTok{p\_load}\NormalTok{( }\CommentTok{\# let pacman control packages}
    \StringTok{"data.table"}\NormalTok{,  }\CommentTok{\# data handling}
    \StringTok{"ini"}\NormalTok{,  }\CommentTok{\# for initialization}
    \StringTok{"httr"}\NormalTok{,  }\CommentTok{\# OAuth}
    \StringTok{"jsonlite"}\NormalTok{,  }\CommentTok{\# JSON parsing}
    \StringTok{"bigrquery"}\NormalTok{,}
    \StringTok{"ggplot2"}\NormalTok{,}
    \StringTok{"forecast"}\NormalTok{,}
    \StringTok{"lubridate"}\NormalTok{,}
    \StringTok{"futile.logger"}\NormalTok{,}
    \StringTok{"argparse"}\NormalTok{,}
    \StringTok{"imputeTS"}\NormalTok{,}
    \StringTok{"gridExtra"}\NormalTok{,}
    \StringTok{"tidyr"}\NormalTok{,}
    \StringTok{"quantmod"}\NormalTok{,}
    \StringTok{"zoo"}\NormalTok{,}
    \StringTok{"GGally"}\NormalTok{,}
    \StringTok{"caret"}\NormalTok{,}
    \StringTok{"dplyr"}\NormalTok{,}
    \StringTok{"nnfor"}\NormalTok{,}
    \StringTok{"prophet"}\NormalTok{,}
    \StringTok{"xlsx"}\NormalTok{,}
    \StringTok{"DataCombine"}\NormalTok{,}
    \StringTok{"googledrive"}\NormalTok{,}
    \StringTok{"XLConnect"}\NormalTok{,}
    \StringTok{"tools"}\NormalTok{,}
    \StringTok{"crayon"}
\NormalTok{  )}
  
\NormalTok{  first.month.to.forecast }\OtherTok{\textless{}{-}} \FunctionTok{as.yearmon}\NormalTok{(}\FunctionTok{Sys.Date}\NormalTok{())          }\CommentTok{\# By default, the first month to forecast is the ongoing month.}
\NormalTok{  start\_test }\OtherTok{\textless{}{-}} \FunctionTok{as.yearmon}\NormalTok{(}\FunctionTok{Sys.Date}\NormalTok{() }\SpecialCharTok{{-}} \FunctionTok{years}\NormalTok{(}\DecValTok{1}\NormalTok{))            }\CommentTok{\# By default, the test set starts from one year ago.}
  
  \ControlFlowTok{if}\NormalTok{(disablePreviousMonthDataCheckFlag) \{}
\NormalTok{    first.month.to.forecast }\OtherTok{\textless{}{-}} \FunctionTok{as.yearmon}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(first.month.to.forecast) }\SpecialCharTok{\%m{-}\%} \FunctionTok{months}\NormalTok{(}\DecValTok{1}\NormalTok{))    }\CommentTok{\# Subtract the number of months from now wanted to be disregarded. By default subtract one month (e.g if data missing from the previous month).}
\NormalTok{    start\_test }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(start\_test) }\SpecialCharTok{\%m{-}\%} \FunctionTok{months}\NormalTok{(}\DecValTok{1}\NormalTok{)                                          }\CommentTok{\# Subtract the same number of months as above from the start test date.}
\NormalTok{  \}}
  
\NormalTok{  start\_test }\OtherTok{\textless{}{-}} \FunctionTok{as.character}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(start\_test))}
\NormalTok{  start\_train }\OtherTok{\textless{}{-}} \StringTok{"2015{-}06{-}01"}
\NormalTok{  id\_of\_ts }\OtherTok{\textless{}{-}} \StringTok{"USGDPGR"}
  
  \ControlFlowTok{if}\NormalTok{(}\SpecialCharTok{!}\NormalTok{skipFetchingDataFlag) \{}
\NormalTok{    dataFull }\OtherTok{\textless{}{-}} \FunctionTok{preprocess\_data}\NormalTok{(}\AttributeTok{since =} \StringTok{"2013{-}02{-}01"}\NormalTok{, }\AttributeTok{query =}\NormalTok{ id\_of\_ts, first.month.to.forecast)}
\NormalTok{    dataAggr }\OtherTok{\textless{}{-}} \FunctionTok{preprocess\_data}\NormalTok{(}\AttributeTok{since =} \StringTok{"2013{-}02{-}01"}\NormalTok{, }\AttributeTok{query =}\NormalTok{ id\_of\_ts, first.month.to.forecast)}
\NormalTok{  \}}
  
  \CommentTok{\# Let\textquotesingle{}s keep this row here in comments and uncomment it if we want to see what the predictions would have been for months already realized. Set the filter condition}
  \CommentTok{\# below to the first day of the month you want filtered out (and all months that come after it).}
  \CommentTok{\# dataFull \textless{}{-} dataFull[format(dataFull$Date, "\%Y{-}\%m") \textless{} format(as.Date("2018{-}01{-}01"), "\%Y{-}\%m"),]}
  
\NormalTok{  progressCounter }\OtherTok{\textless{}{-}} \DecValTok{1}

  \ControlFlowTok{if}\NormalTok{(skipComputingForecastsFlag) \{}
\NormalTok{    progressCounter }\OtherTok{\textless{}{-}}\NormalTok{ progressCounter }\SpecialCharTok{+} \FunctionTok{length}\NormalTok{(id\_of\_tss)}
    \FunctionTok{flog.info}\NormalTok{(}\FunctionTok{cat}\NormalTok{(}\FunctionTok{red}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Skipping computing forecasts and trying to read them from memory instead as skipComputingForecastsFlag is set to TRUE.}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{))))}
    \ControlFlowTok{next} \CommentTok{\# If wanted to skip making the forecasts.}
\NormalTok{  \}}
  
  \ControlFlowTok{if}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.null}\NormalTok{(dataFull)) \{}
\NormalTok{    list.ts }\OtherTok{\textless{}{-}} \FunctionTok{monthly\_decomposition}\NormalTok{(dataFull, id\_of\_ts, imputations.output.filename) }\CommentTok{\# Make the time series object.}
    
\NormalTok{    forecastValues.best.model.names.per.step.and.forecasts.per.month }\OtherTok{\textless{}{-}} \FunctionTok{split\_data\_and\_model\_monthly}\NormalTok{(dataFull, list.ts, id\_of\_ts, months.ahead, start\_test, start\_train, first.month.to.forecast, mape.output.filename, script.name, progressCounter, skipTimeConsumingAlgorithmsFlag)}

    \CommentTok{\# print.progress(progressCounter, dataFull, id\_of\_ts)}
      
    \ControlFlowTok{if}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.null}\NormalTok{(forecastValues.best.model.names.per.step.and.forecasts.per.month)) \{}
      \CommentTok{\# create.excel(forecastValues.best.model.names.per.step.and.forecasts.per.month[[3]], forecastValues.best.model.names.per.step.and.forecasts.per.month[[2]], id\_of\_ts) \# }\AlertTok{TODO}
\NormalTok{    \}              }
    \ControlFlowTok{if}\NormalTok{ (plotModelQuadrantGraphFlag }\SpecialCharTok{|}\NormalTok{ plotBestPerformerErrorGraphsFlag) \{ }\CommentTok{\# If either flag was set, plot the corresponding plot(s).}
\NormalTok{      plots }\OtherTok{\textless{}{-}} \FunctionTok{plot\_base\_forecasts}\NormalTok{(}\AttributeTok{forecasts =}\NormalTok{ forecastValues.best.model.names.per.step.and.forecasts.per.month[[}\DecValTok{5}\NormalTok{]], }\AttributeTok{best.model.performance =}\NormalTok{ forecastValues.best.model.names.per.step.and.forecasts.per.month[[}\DecValTok{3}\NormalTok{]], months.ahead, id\_of\_ts, plotModelQuadrantGraphFlag, plotBestPerformerErrorGraphsFlag)}
\NormalTok{    \}}

    \FunctionTok{print}\NormalTok{(}\StringTok{"The best performing models for current month, current + 1 month, current + 2 months, and current + 3 months:"}\NormalTok{)}
    \FunctionTok{print}\NormalTok{(forecastValues.best.model.names.per.step.and.forecasts.per.month[[}\DecValTok{2}\NormalTok{]])}
    \FunctionTok{print}\NormalTok{(forecastValues.best.model.names.per.step.and.forecasts.per.month[[}\DecValTok{3}\NormalTok{]])}

    \CommentTok{\# }\AlertTok{TODO}\CommentTok{:}
    \CommentTok{\# plot.summary.graph(id\_of\_ts, demandsAndForecastWithYearCols, graph.filename, first.month.to.forecast)}
\NormalTok{  \}   }
\NormalTok{  progressCounter }\OtherTok{\textless{}{-}}\NormalTok{ progressCounter }\SpecialCharTok{+} \DecValTok{1}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{start\_modeling\_process}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: pacman
\end{verbatim}

\begin{verbatim}
## Installing package into '/home/jaakkpaa/R/x86_64-pc-linux-gnu-library/4.3'
## (as 'lib' is unspecified)
\end{verbatim}

\begin{verbatim}
## also installing the dependencies 'rJava', 'xlsxjars'
\end{verbatim}

\begin{verbatim}
## Warning in utils::install.packages(package, ...): installation of package
## 'rJava' had non-zero exit status
\end{verbatim}

\begin{verbatim}
## Warning in utils::install.packages(package, ...): installation of package
## 'xlsxjars' had non-zero exit status
\end{verbatim}

\begin{verbatim}
## Warning in utils::install.packages(package, ...): installation of package
## 'xlsx' had non-zero exit status
\end{verbatim}

\begin{verbatim}
## Warning in p_install(package, character.only = TRUE, ...):
\end{verbatim}

\begin{verbatim}
## Warning in library(package, lib.loc = lib.loc, character.only = TRUE,
## logical.return = TRUE, : there is no package called 'xlsx'
\end{verbatim}

\begin{verbatim}
## Installing package into '/home/jaakkpaa/R/x86_64-pc-linux-gnu-library/4.3'
## (as 'lib' is unspecified)
\end{verbatim}

\begin{verbatim}
## also installing the dependency 'rJava'
\end{verbatim}

\begin{verbatim}
## Warning in utils::install.packages(package, ...): installation of package
## 'rJava' had non-zero exit status
\end{verbatim}

\begin{verbatim}
## Warning in utils::install.packages(package, ...): installation of package
## 'XLConnect' had non-zero exit status
\end{verbatim}

\begin{verbatim}
## Warning in p_install(package, character.only = TRUE, ...):
\end{verbatim}

\begin{verbatim}
## Warning in library(package, lib.loc = lib.loc, character.only = TRUE,
## logical.return = TRUE, : there is no package called 'XLConnect'
\end{verbatim}

\begin{verbatim}
## Warning in pacman::p_load("data.table", "ini", "httr", "jsonlite", "bigrquery", : Failed to install/load:
## xlsx, XLConnect
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:47] Loading data
## INFO [2024-03-19 15:43:47] Loading data
## Step 1 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:47] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:47] USGDPGR: Trend + Seasonal regression trained
## INFO [2024-03-19 15:43:47] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:47] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:47] USGDPGR: Predictions made for tslm 2020-09-01
## INFO [2024-03-19 15:43:47] USGDPGR: Predictions made for tslm 2020-10-01
## INFO [2024-03-19 15:43:47] USGDPGR: Predictions made for tslm 2020-11-01
## INFO [2024-03-19 15:43:47] USGDPGR: Predictions made for tslm 2020-12-01
## INFO [2024-03-19 15:43:47] USGDPGR: Predictions made for tslm 2020-09-01
## INFO [2024-03-19 15:43:47] USGDPGR: Predictions made for tslm 2020-10-01
## INFO [2024-03-19 15:43:47] USGDPGR: Predictions made for tslm 2020-11-01
## INFO [2024-03-19 15:43:47] USGDPGR: Predictions made for tslm 2020-12-01
## INFO [2024-03-19 15:43:47] USGDPGR: Predictions made for HoltWinters 2020-09-01
## INFO [2024-03-19 15:43:47] USGDPGR: Predictions made for HoltWinters 2020-10-01
## INFO [2024-03-19 15:43:47] USGDPGR: Predictions made for HoltWinters 2020-11-01
## INFO [2024-03-19 15:43:47] USGDPGR: Predictions made for HoltWinters 2020-12-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2020-09-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2020-10-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2020-11-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2020-12-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2020-09-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2020-10-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2020-11-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2020-12-01
## Step 2 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:48] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:48] USGDPGR: Trend + Seasonal regression trained
## INFO [2024-03-19 15:43:48] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:48] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2020-10-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2020-11-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2020-12-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-01-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2020-10-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2020-11-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2020-12-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-01-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2020-10-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2020-11-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2020-12-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-01-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2020-10-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2020-11-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2020-12-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-01-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2020-10-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2020-11-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2020-12-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2021-01-01
## Step 3 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:48] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:48] USGDPGR: Trend + Seasonal regression trained
## INFO [2024-03-19 15:43:48] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:48] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2020-11-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2020-12-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-01-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-02-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2020-11-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2020-12-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-01-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-02-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2020-11-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2020-12-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-01-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-02-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2020-11-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2020-12-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-01-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-02-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2020-11-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2020-12-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2021-01-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2021-02-01
## Step 4 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:48] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:48] USGDPGR: Trend + Seasonal regression trained
## INFO [2024-03-19 15:43:48] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:48] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2020-12-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-01-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-02-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-03-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2020-12-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-01-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-02-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-03-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2020-12-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-01-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-02-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-03-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2020-12-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-01-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-02-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-03-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2020-12-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2021-01-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2021-02-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2021-03-01
## Step 5 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:48] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:48] USGDPGR: Trend + Seasonal regression trained
## INFO [2024-03-19 15:43:48] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:48] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-01-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-02-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-03-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-04-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-01-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-02-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-03-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-04-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-01-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-02-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-03-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-04-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-01-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-02-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-03-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-04-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2021-01-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2021-02-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2021-03-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2021-04-01
## Step 6 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:48] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:48] USGDPGR: Trend + Seasonal regression trained
## INFO [2024-03-19 15:43:48] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:48] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-02-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-03-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-04-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-05-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-02-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-03-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-04-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-05-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-02-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-03-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-04-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-05-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-02-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-03-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-04-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-05-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2021-02-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2021-03-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2021-04-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2021-05-01
## Step 7 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:48] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:48] USGDPGR: Trend + Seasonal regression trained
## INFO [2024-03-19 15:43:48] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:48] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-03-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-04-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-05-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-06-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-03-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-04-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-05-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for tslm 2021-06-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-03-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-04-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-05-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-06-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-03-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-04-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-05-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for HoltWinters 2021-06-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2021-03-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2021-04-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2021-05-01
## INFO [2024-03-19 15:43:48] USGDPGR: Predictions made for Naive no  1 2021-06-01
## Step 8 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:49] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:49] USGDPGR: Trend + Seasonal regression trained
## INFO [2024-03-19 15:43:49] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:49] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-04-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-05-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-06-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-07-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-04-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-05-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-06-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-07-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-04-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-05-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-06-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-07-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-04-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-05-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-06-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-07-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-04-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-05-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-06-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-07-01
## Step 9 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:49] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:49] USGDPGR: Trend + Seasonal regression trained
## INFO [2024-03-19 15:43:49] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:49] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-05-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-06-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-07-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-08-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-05-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-06-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-07-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-08-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-05-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-06-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-07-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-08-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-05-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-06-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-07-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-08-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-05-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-06-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-07-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-08-01
## Step 10 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:49] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:49] USGDPGR: Trend + Seasonal regression trained
## INFO [2024-03-19 15:43:49] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:49] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-06-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-07-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-08-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-09-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-06-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-07-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-08-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-09-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-06-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-07-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-08-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-09-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-06-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-07-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-08-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-09-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-06-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-07-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-08-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-09-01
## Step 11 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:49] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:49] USGDPGR: Trend + Seasonal regression trained
## INFO [2024-03-19 15:43:49] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:49] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-07-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-08-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-09-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-10-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-07-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-08-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-09-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-10-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-07-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-08-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-09-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-10-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-07-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-08-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-09-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-10-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-07-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-08-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-09-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-10-01
## Step 12 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:49] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:49] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:49] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:49] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-08-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-09-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-10-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-11-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-08-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-09-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-10-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-11-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-08-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-09-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-10-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-11-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-08-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-09-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-10-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-11-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-08-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-09-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-10-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-11-01
## Step 13 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:49] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:49] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:49] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:49] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-09-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-10-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-11-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-12-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-09-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-10-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-11-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for tslm 2021-12-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-09-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-10-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-11-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-12-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-09-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-10-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-11-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for HoltWinters 2021-12-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-09-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-10-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-11-01
## INFO [2024-03-19 15:43:49] USGDPGR: Predictions made for Naive no  1 2021-12-01
## Step 14 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:49] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:49] USGDPGR: Trend + Seasonal regression trained
## INFO [2024-03-19 15:43:49] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:49] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2021-10-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2021-11-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2021-12-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-01-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2021-10-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2021-11-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2021-12-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-01-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2021-10-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2021-11-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2021-12-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-01-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2021-10-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2021-11-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2021-12-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-01-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2021-10-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2021-11-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2021-12-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2022-01-01
## Step 15 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:50] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:50] USGDPGR: Trend + Seasonal regression trained
## INFO [2024-03-19 15:43:50] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:50] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2021-11-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2021-12-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-01-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-02-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2021-11-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2021-12-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-01-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-02-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2021-11-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2021-12-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-01-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-02-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2021-11-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2021-12-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-01-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-02-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2021-11-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2021-12-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2022-01-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2022-02-01
## Step 16 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:50] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:50] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:50] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:50] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2021-12-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-01-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-02-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-03-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2021-12-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-01-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-02-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-03-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2021-12-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-01-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-02-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-03-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2021-12-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-01-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-02-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-03-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2021-12-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2022-01-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2022-02-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2022-03-01
## Step 17 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:50] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:50] USGDPGR: Trend + Seasonal regression trained
## INFO [2024-03-19 15:43:50] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:50] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-01-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-02-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-03-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-04-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-01-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-02-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-03-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-04-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-01-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-02-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-03-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-04-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-01-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-02-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-03-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-04-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2022-01-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2022-02-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2022-03-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2022-04-01
## Step 18 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:50] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:50] USGDPGR: Trend + Seasonal regression trained
## INFO [2024-03-19 15:43:50] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:50] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-02-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-03-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-04-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-05-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-02-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-03-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-04-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-05-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-02-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-03-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-04-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-05-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-02-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-03-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-04-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-05-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2022-02-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2022-03-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2022-04-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2022-05-01
## Step 19 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:50] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:50] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:50] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:50] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-03-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-04-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-05-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-06-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-03-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-04-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-05-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-06-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-03-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-04-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-05-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-06-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-03-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-04-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-05-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for HoltWinters 2022-06-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2022-03-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2022-04-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2022-05-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for Naive no  1 2022-06-01
## Step 20 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:50] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:50] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:50] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:50] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-04-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-05-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-06-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-07-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-04-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-05-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-06-01
## INFO [2024-03-19 15:43:50] USGDPGR: Predictions made for tslm 2022-07-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-04-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-05-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-06-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-07-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-04-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-05-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-06-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-07-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-04-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-05-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-06-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-07-01
## Step 21 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:51] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:51] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:51] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:51] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-05-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-06-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-07-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-08-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-05-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-06-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-07-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-08-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-05-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-06-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-07-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-08-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-05-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-06-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-07-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-08-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-05-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-06-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-07-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-08-01
## Step 22 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:51] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:51] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:51] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:51] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-06-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-07-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-08-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-09-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-06-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-07-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-08-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-09-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-06-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-07-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-08-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-09-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-06-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-07-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-08-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-09-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-06-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-07-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-08-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-09-01
## Step 23 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:51] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:51] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:51] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:51] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-07-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-08-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-09-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-10-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-07-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-08-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-09-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-10-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-07-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-08-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-09-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-10-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-07-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-08-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-09-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-10-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-07-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-08-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-09-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-10-01
## Step 24 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:51] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:51] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:51] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:51] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-08-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-09-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-10-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-11-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-08-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-09-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-10-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-11-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-08-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-09-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-10-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-11-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-08-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-09-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-10-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-11-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-08-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-09-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-10-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-11-01
## Step 25 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:51] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:51] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:51] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:51] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-09-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-10-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-11-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-12-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-09-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-10-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-11-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-12-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-09-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-10-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-11-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-12-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-09-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-10-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-11-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-12-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-09-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-10-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-11-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for Naive no  1 2022-12-01
## Step 26 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:51] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:51] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:51] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:51] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-10-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-11-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-12-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2023-01-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-10-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-11-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2022-12-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for tslm 2023-01-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-10-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-11-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2022-12-01
## INFO [2024-03-19 15:43:51] USGDPGR: Predictions made for HoltWinters 2023-01-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2022-10-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2022-11-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2022-12-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-01-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2022-10-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2022-11-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2022-12-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2023-01-01
## Step 27 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:52] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:52] USGDPGR: Trend + Seasonal regression trained
## INFO [2024-03-19 15:43:52] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:52] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2022-11-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2022-12-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-01-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-02-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2022-11-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2022-12-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-01-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-02-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2022-11-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2022-12-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-01-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-02-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2022-11-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2022-12-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-01-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-02-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2022-11-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2022-12-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2023-01-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2023-02-01
## Step 28 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:52] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:52] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:52] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:52] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2022-12-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-01-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-02-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-03-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2022-12-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-01-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-02-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-03-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2022-12-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-01-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-02-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-03-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2022-12-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-01-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-02-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-03-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2022-12-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2023-01-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2023-02-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2023-03-01
## Step 29 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:52] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:52] USGDPGR: Trend + Seasonal regression trained
## INFO [2024-03-19 15:43:52] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:52] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-01-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-02-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-03-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-04-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-01-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-02-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-03-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-04-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-01-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-02-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-03-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-04-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-01-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-02-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-03-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-04-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2023-01-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2023-02-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2023-03-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2023-04-01
## Step 30 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:52] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:52] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:52] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:52] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-02-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-03-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-04-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-05-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-02-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-03-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-04-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-05-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-02-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-03-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-04-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-05-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-02-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-03-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-04-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-05-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2023-02-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2023-03-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2023-04-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2023-05-01
## Step 31 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:52] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:52] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:52] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:52] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-03-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-04-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-05-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-06-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-03-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-04-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-05-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-06-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-03-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-04-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-05-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-06-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-03-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-04-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-05-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for HoltWinters 2023-06-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2023-03-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2023-04-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2023-05-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for Naive no  1 2023-06-01
## Step 32 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:52] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:52] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:52] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:52] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-04-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-05-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-06-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-07-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-04-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-05-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-06-01
## INFO [2024-03-19 15:43:52] USGDPGR: Predictions made for tslm 2023-07-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-04-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-05-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-06-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-07-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-04-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-05-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-06-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-07-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-04-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-05-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-06-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-07-01
## Step 33 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:53] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:53] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:53] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:53] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-05-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-06-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-07-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-08-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-05-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-06-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-07-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-08-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-05-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-06-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-07-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-08-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-05-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-06-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-07-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-08-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-05-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-06-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-07-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-08-01
## Step 34 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:53] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:53] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:53] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:53] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-06-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-07-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-08-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-09-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-06-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-07-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-08-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-09-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-06-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-07-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-08-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-09-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-06-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-07-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-08-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-09-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-06-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-07-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-08-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-09-01
## Step 35 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:53] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:53] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:53] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:53] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-07-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-08-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-09-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-10-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-07-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-08-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-09-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-10-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-07-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-08-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-09-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-10-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-07-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-08-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-09-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-10-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-07-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-08-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-09-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-10-01
## Step 36 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:53] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:53] USGDPGR: Trend + Seasonal regression trained
## INFO [2024-03-19 15:43:53] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:53] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-08-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-09-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-10-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-11-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-08-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-09-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-10-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-11-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-08-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-09-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-10-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-11-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-08-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-09-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-10-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-11-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-08-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-09-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-10-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-11-01
## Step 37 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:53] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:53] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:53] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:53] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-09-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-10-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-11-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-12-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-09-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-10-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-11-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-12-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-09-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-10-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-11-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-12-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-09-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-10-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-11-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for HoltWinters 2023-12-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-09-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-10-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-11-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for Naive no  1 2023-12-01
## Step 38 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:53] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:53] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:53] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:53] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-10-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-11-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2023-12-01
## INFO [2024-03-19 15:43:53] USGDPGR: Predictions made for tslm 2024-01-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2023-10-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2023-11-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2023-12-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2024-01-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2023-10-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2023-11-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2023-12-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2024-01-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2023-10-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2023-11-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2023-12-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2024-01-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for Naive no  1 2023-10-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for Naive no  1 2023-11-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for Naive no  1 2023-12-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for Naive no  1 2024-01-01
## Step 39 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:54] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:54] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:54] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:54] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2023-11-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2023-12-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2024-01-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2024-02-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2023-11-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2023-12-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2024-01-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2024-02-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2023-11-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2023-12-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2024-01-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2024-02-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2023-11-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2023-12-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2024-01-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2024-02-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for Naive no  1 2023-11-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for Naive no  1 2023-12-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for Naive no  1 2024-01-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for Naive no  1 2024-02-01
## Step 40 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:54] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:54] USGDPGR: Trend + Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in HoltWinters(ts_train, seasonal = "mul"): optimization difficulties:
## ERROR: ABNORMAL_TERMINATION_IN_LNSRCH
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:54] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:54] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2023-12-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2024-01-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2024-02-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2024-03-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2023-12-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2024-01-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2024-02-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2024-03-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2023-12-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2024-01-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2024-02-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2024-03-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2023-12-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2024-01-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2024-02-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2024-03-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for Naive no  1 2023-12-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for Naive no  1 2024-01-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for Naive no  1 2024-02-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for Naive no  1 2024-03-01
## Step 41 out of 41
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:54] USGDPGR: Seasonal regression trained
\end{verbatim}

\begin{verbatim}
## Warning in guerrero(x, lower, upper): Guerrero's method for selecting a Box-Cox
## parameter (lambda) is given for strictly positive data.
\end{verbatim}

\begin{verbatim}
## INFO [2024-03-19 15:43:54] USGDPGR: Trend + Seasonal regression trained
## INFO [2024-03-19 15:43:54] USGDPGR: Holt-Winters multiplicative trained
## INFO [2024-03-19 15:43:54] USGDPGR: Holt-Winters additive trained
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2024-01-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2024-02-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2024-03-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2024-04-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2024-01-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2024-02-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2024-03-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for tslm 2024-04-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2024-01-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2024-02-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2024-03-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2024-04-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2024-01-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2024-02-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2024-03-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for HoltWinters 2024-04-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for Naive no  1 2024-01-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for Naive no  1 2024-02-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for Naive no  1 2024-03-01
## INFO [2024-03-19 15:43:54] USGDPGR: Predictions made for Naive no  1 2024-04-01
## INFO [2024-03-19 15:43:54] Evaluating models
## INFO [2024-03-19 15:43:54] Evaluating 1_ahead
## INFO [2024-03-19 15:43:54] Preparing data for evaluation
## INFO [2024-03-19 15:43:54] Getting the error metrics.
## INFO [2024-03-19 15:43:54] Determining the best models for 1_ahead
## INFO [2024-03-19 15:43:54] Evaluating 2_ahead
## INFO [2024-03-19 15:43:54] Preparing data for evaluation
## INFO [2024-03-19 15:43:54] Getting the error metrics.
## INFO [2024-03-19 15:43:54] Determining the best models for 2_ahead
## INFO [2024-03-19 15:43:54] Evaluating 3_ahead
## INFO [2024-03-19 15:43:54] Preparing data for evaluation
## INFO [2024-03-19 15:43:54] Getting the error metrics.
## INFO [2024-03-19 15:43:54] Determining the best models for 3_ahead
## INFO [2024-03-19 15:43:54] Evaluating 4_ahead
## INFO [2024-03-19 15:43:54] Preparing data for evaluation
## INFO [2024-03-19 15:43:54] Getting the error metrics.
## INFO [2024-03-19 15:43:54] Determining the best models for 4_ahead
## The contents of temp.list:
## [[1]] are the 'best-performer out-of-sample forecasts' for each four, truly out-of-sample steps,
## [[2]] is the name of the 'best-performer' for those forecasts, respectively,
## [[3]] is the 'best-performer's' predictive performance metrics for each step in the test set, and
## [[4]] is the dataframe with all the observations and all the forecasts, both in-the-sample and out-of-sample.
\end{verbatim}

\begin{verbatim}
## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion
\end{verbatim}

\begin{verbatim}
## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion

## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion

## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion

## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion

## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion
\end{verbatim}

\includegraphics{timeseries_forecast_rmarkdown_files/figure-latex/unnamed-chunk-4-1.pdf}
\includegraphics{timeseries_forecast_rmarkdown_files/figure-latex/unnamed-chunk-4-2.pdf}

\begin{verbatim}
## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion

## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion

## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion

## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion

## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion

## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion
\end{verbatim}

\includegraphics{timeseries_forecast_rmarkdown_files/figure-latex/unnamed-chunk-4-3.pdf}
\includegraphics{timeseries_forecast_rmarkdown_files/figure-latex/unnamed-chunk-4-4.pdf}
\includegraphics{timeseries_forecast_rmarkdown_files/figure-latex/unnamed-chunk-4-5.pdf}

\begin{verbatim}
## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion

## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion

## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion

## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion

## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion

## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion
\end{verbatim}

\includegraphics{timeseries_forecast_rmarkdown_files/figure-latex/unnamed-chunk-4-6.pdf}
\includegraphics{timeseries_forecast_rmarkdown_files/figure-latex/unnamed-chunk-4-7.pdf}
\includegraphics{timeseries_forecast_rmarkdown_files/figure-latex/unnamed-chunk-4-8.pdf}

\begin{verbatim}
## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion

## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion

## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion

## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion

## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion

## Warning in na_replace(as.numeric(substr(forecasts$type, 1, 1)), 99): NAs
## introduced by coercion
\end{verbatim}

\includegraphics{timeseries_forecast_rmarkdown_files/figure-latex/unnamed-chunk-4-9.pdf}
\includegraphics{timeseries_forecast_rmarkdown_files/figure-latex/unnamed-chunk-4-10.pdf}
\includegraphics{timeseries_forecast_rmarkdown_files/figure-latex/unnamed-chunk-4-11.pdf}
\includegraphics{timeseries_forecast_rmarkdown_files/figure-latex/unnamed-chunk-4-12.pdf}

\begin{verbatim}
## [1] "The best performing models for current month, current + 1 month, current + 2 months, and current + 3 months:"
## [1] "HW.Add"             "HW.Add"             "Reg.trend.seasonal"
## [4] "HW.Add"            
##      name         MAPE  MAE       Date
## 1  HW.Add   0.55555556  2.5 2020-12-01
## 2  HW.Add   0.37254902  1.9 2021-01-01
## 3  HW.Add   0.22807018  1.3 2021-02-01
## 4  HW.Add   0.47619048  3.0 2021-03-01
## 5  HW.Add  -0.68750000 -4.4 2021-04-01
## 6  HW.Add  -0.01515152 -0.1 2021-05-01
## 7  HW.Add   0.38805970  2.6 2021-06-01
## 8  HW.Add   0.66071429  3.7 2021-07-01
## 9  HW.Add   1.11363636  4.9 2021-08-01
## 10 HW.Add   1.45454545  4.8 2021-09-01
## 11 HW.Add   0.35555556  1.6 2021-10-01
## 12 HW.Add  -0.12068966 -0.7 2021-11-01
## 13 HW.Add  -0.45714286 -3.2 2021-12-01
## 14 HW.Add  -0.55000000 -2.2 2022-01-01
## 15 HW.Add   0.00000000  0.0 2022-02-01
## 16 HW.Add  -1.40000000  2.8 2022-03-01
## 17 HW.Add  -4.00000000  6.0 2022-04-01
## 18 HW.Add  -5.90909091  6.5 2022-05-01
## 19 HW.Add -11.66666667  7.0 2022-06-01
## 20 HW.Add   8.60000000  4.3 2022-07-01
## 21 HW.Add   0.87500000  1.4 2022-08-01
## 22 HW.Add  -0.85185185 -2.3 2022-09-01
## 23 HW.Add  -1.44444444 -3.9 2022-10-01
## 24 HW.Add  -1.00000000 -2.6 2022-11-01
## 25 HW.Add  -0.61538462 -1.6 2022-12-01
## 26 HW.Add  -0.52000000 -1.3 2023-01-01
## 27 HW.Add  -1.34782609 -3.1 2023-02-01
## 28 HW.Add  -2.09090909 -4.6 2023-03-01
## 29 HW.Add  -0.95454545 -2.1 2023-04-01
## 30 HW.Add   0.85714286  1.8 2023-05-01
## 31 HW.Add   2.66666667  5.6 2023-06-01
## 32 HW.Add   2.00000000  6.0 2023-07-01
## 33 HW.Add   0.67500000  2.7 2023-08-01
## 34 HW.Add  -0.26530612 -1.3 2023-09-01
## 35 HW.Add  -0.65116279 -2.8 2023-10-01
## 36 HW.Add  -0.36842105 -1.4 2023-11-01
## 37 HW.Add   0.03125000  0.1 2023-12-01
\end{verbatim}

\end{document}
